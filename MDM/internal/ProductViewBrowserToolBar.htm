<!-- MDM PVB TOOBAR
		Part of the HTML file comes from MPS and was changed to work with the MDM Product View Browser!
		This toolbar display the icon gray and static no link!
		F.Torres. 9/2/2000 - 12/13/2000
		F.Torres. 4/9/2001 - Support of search/filter mode.
    F.Torres. 1/22/2002 - Advanced filter interaction    
 -->
<SCRIPT language="javascript">
	<!--//
	function buttonRollover(aName, aRollImage)
  {
    try
    {
      document[aName].src = aRollImage;
    }
    catch(exp)
    {
    }
  } 	
	function setMsg(aMsg)
  {
    window.status = aMsg;
  }
  function StartExport()
  {
    document.all._export.src = "[HTTP_ASP_FILE]?mdmPageAction=EXPORT&mdmPageIndex=[PAGE_INDEX]&mdmFormUniqueKey=[MDM_FORM_UNIQUE_KEY]";
  }
	// -->
</SCRIPT>
<iframe src="/mdm/blank.htm" id="_export" name="_export" style="display:none;"></iframe>
<input id="HiddenBetween" type="hidden" name="HiddenBetween" value="[MDM_DATETIME_BETWEEN]" />
<!-- Do not change the formating because the tool bar is not display correctly! Ok it is very annoying... -->
<TABLE WIDTH="100%" CELLPADDING=0 CELLSPACING=0 BORDER=0>
<TR ALIGN=LEFT VALIGN=TOP>
<TD nowrap BACKGROUND="/mdm/internal/images/toolbar/toolbarTile.gif" ALIGN=LEFT BGCOLOR="SILVER">
<img src="/mdm/internal/images/toolbar/toolbarLeftCap.gif" width=5 height=32	border="0"></TD>
<TD nowrap ALIGN=LEFT BGCOLOR="SILVER" BACKGROUND="/mdm/internal/images/toolbar/toolbarTile.gif"><img src="/mdm/internal/images/toolbar/toolbarIconTopCap.gif" width=25 height=3  border="0"><BR><A HREF='[HTTP_ASP_FILE]?mdmPageAction=REFRESH&mdmPageIndex=[PAGE_INDEX]&mdmFormUniqueKey=[MDM_FORM_UNIQUE_KEY]' onMouseOver="buttonRollover('RefreshImage','/mdm/internal/images/toolbar/refresh_rolled.gif'); /*window.status='[REFRESH_PAGE_TOOL_TIP]';*/ return true;" onMouseOut="buttonRollover('RefreshImage','/mdm/internal/images/toolbar/refresh_enabled.gif'); window.status=''; return true;"><IMG NAME="RefreshImage" SRC="/mdm/internal/images/toolbar/refresh_enabled.gif" alt="[REFRESH_PAGE_TOOL_TIP]" BORDER="0" WIDTH="25" HEIGHT="25"></A>
#MDMIf MDM_PVB_EXPORT_MODE
<A HREF="JavaScript:StartExport();" onMouseOver="buttonRollover('ExportImage' ,'/mdm/internal/images/toolbar/export_rolled.gif' ); return true;" onMouseOut="buttonRollover('ExportImage' ,'/mdm/internal/images/toolbar/export_enabled.gif' ); window.status=''; return true;"><IMG NAME="ExportImage" SRC="/mdm/internal/images/toolbar/export_enabled.gif"	alt="[EXPORT_PAGE_TOOL_TIP]" BORDER="0" WIDTH="25" HEIGHT="25"></A>
#MDMEndIf
</TD>
<TD nowrap BACKGROUND="/mdm/internal/images/toolbar/toolbarTile.gif" ALIGN=LEFT BGCOLOR="SILVER">
<img src="/mdm/internal/images/toolbar/toolbarSplit.gif" width=42 height=32  border="0"></TD>
<TD nowrap ALIGN=LEFT BGCOLOR="SILVER" BACKGROUND="/mdm/internal/images/toolbar/toolbarTile.gif">
<img src="/mdm/internal/images/toolbar/toolbarIconTopCap.gif" width=25 height=3  border="0"><BR><A HREF='javascript:mdm_PVBPageEventRaiser("FirstPage",[PAGE_INDEX]);' onMouseOver="buttonRollover('FirstPageImage','/mdm/internal/images/toolbar/firstpage_[ROLLED_IMAGE].gif'); /*window.status='[FIRST_PAGE_TOOL_TIP]';*/ return true;" onMouseOut="buttonRollover('FirstPageImage','/mdm/internal/images/toolbar/firstpage_[ENABLED_IMAGE].gif'); window.status=''; return true;"><IMG NAME="FirstPageImage" SRC="/mdm/internal/images/toolbar/firstpage_[ENABLED_IMAGE].gif" alt="[FIRST_PAGE_TOOL_TIP]" BORDER="0" WIDTH="25" HEIGHT="25"></A><BR><img src="/mdm/internal/images/toolbar/toolbarIconBottomCap.gif" width=25 height=4  border="0"></TD>
<TD nowrap ALIGN=LEFT BGCOLOR="SILVER" BACKGROUND="/mdm/internal/images/toolbar/toolbarTile.gif"><img src="/mdm/internal/images/toolbar/toolbarIconTopCap.gif" width=25 height=3  border="0"><BR><A HREF='javascript:mdm_PVBPageEventRaiser("PreviousPage",[PAGE_INDEX]);' onMouseOver="buttonRollover('PreviousPageImage','/mdm/internal/images/toolbar/previouspage_[ROLLED_IMAGE].gif'); /*window.status='[PREVIOUS_PAGE_TOOL_TIP]';*/ return true;" onMouseOut="buttonRollover('PreviousPageImage','/mdm/internal/images/toolbar/previouspage_[ENABLED_IMAGE].gif'); window.status=''; return true;"><IMG NAME="PreviousPageImage" SRC="/mdm/internal/images/toolbar/previouspage_[ENABLED_IMAGE].gif" alt="[PREVIOUS_PAGE_TOOL_TIP]" BORDER="0" WIDTH="25" HEIGHT="25"></A><BR><img src="/mdm/internal/images/toolbar/toolbarIconBottomCap.gif" width=25 height=4	border="0"></TD>
<TD nowrap BACKGROUND="/mdm/internal/images/toolbar/toolbarTile.gif" ALIGN=CENTER VALIGN=MIDDLE BGCOLOR="SILVER">
<font face="Verdana, Arial, Helvetica" size="1" color="#000000">[MDM_TOOL_BAR_PAGE_WORD] <select name="mdmPvbPageSelect" style="font-size: 10px; width: 40px; height: 20px; vertical-align: baseline;" onChange="mdmPvbGotoPage();"></select> [MDM_TOOL_BAR_OF_WORD] [MAX_PAGE]</FONT></TD>
<TD nowrap ALIGN=LEFT BGCOLOR="SILVER" BACKGROUND="/mdm/internal/images/toolbar/toolbarTile.gif"><img src="/mdm/internal/images/toolbar/toolbarIconTopCap.gif" width=25 height=3  border="0"><BR><A HREF='javascript:mdm_PVBPageEventRaiser("NextPage",[PAGE_INDEX]);' onMouseOver="buttonRollover('NextPageImage','/mdm/internal/images/toolbar/nextpage_[ROLLED_IMAGE].gif'); /*window.status='[NEXT_PAGE_TOOL_TIP]';*/ return true;" onMouseOut="buttonRollover('NextPageImage','/mdm/internal/images/toolbar/nextpage_[ENABLED_IMAGE].gif'); window.status=''; return true;"><IMG NAME="NextPageImage" SRC="/mdm/internal/images/toolbar/nextpage_[ENABLED_IMAGE].gif" alt="[NEXT_PAGE_TOOL_TIP]" BORDER="0" WIDTH="25" HEIGHT="25"></A><BR><img src="/mdm/internal/images/toolbar/toolbarIconBottomCap.gif" width=25 height=4	border="0"></TD>
<TD nowrap ALIGN=LEFT BGCOLOR="SILVER" BACKGROUND="/mdm/internal/images/toolbar/toolbarTile.gif"><img src="/mdm/internal/images/toolbar/toolbarIconTopCap.gif" width=25 height=3  border="0"><BR><A HREF='javascript:mdm_PVBPageEventRaiser("LastPage",[PAGE_INDEX]);' onMouseOver="buttonRollover('LastPageImage','/mdm/internal/images/toolbar/lastpage_[ROLLED_IMAGE].gif'); /*window.status='[LAST_PAGE_TOOL_TIP]';*/ return true;" onMouseOut="buttonRollover('LastPageImage','/mdm/internal/images/toolbar/lastpage_[ENABLED_IMAGE].gif'); window.status=''; return true;"><IMG NAME="LastPageImage" SRC="/mdm/internal/images/toolbar/lastpage_[ENABLED_IMAGE].gif" alt="[LAST_PAGE_TOOL_TIP]" BORDER="0" WIDTH="25" HEIGHT="25"></A><BR><img src="/mdm/internal/images/toolbar/toolbarIconBottomCap.gif" width=25 height=4	border="0"></TD>
<TD nowrap BACKGROUND="/mdm/internal/images/toolbar/toolbarTile.gif" ALIGN=LEFT BGCOLOR="SILVER">
<img src="/mdm/internal/images/toolbar/toolbarSplit.gif" width=42 height=32  border="0"></TD>
<TD nowrap ALIGN=LEFT BGCOLOR="SILVER" BACKGROUND="/mdm/internal/images/toolbar/toolbarTile.gif"> </TD>
#MDMIf MDM_PVB_FILTER_MODE
<TD nowrap BACKGROUND="/mdm/internal/images/toolbar/toolbarTile.gif" valign="Middle" BGCOLOR="SILVER">
&nbsp;<LABEL Name="MDM_PVB_FILTER_PROPERTY_NAME"></LABEL>:<INPUT style="font-size: 10px;" Name="mdmPVBFilter" Type="Text" Size="22">&nbsp;
<BUTTON Class='clsSmallButton' Name='mdmPVBFilterButtonGo' OnClick='mdm_RefreshDialog(this);'><MDMLABEL Name='GO_TOOL_TIP'></MDMLABEL></BUTTON>&nbsp;
<BUTTON Class='clsSmallButton' Name='mdmPVBFilterButtonReset' OnClick='mdm_RefreshDialog(this);'><MDMLABEL Name='RESET_TOOL_TIP'></MDMLABEL></BUTTON>
#MDMEndIf
#MDMIf MDM_PVB_FILTER_MULTI_COLUM_MODE
<TD nowrap BACKGROUND="/mdm/internal/images/toolbar/toolbarTile.gif" valign="Middle" BGCOLOR="SILVER">&nbsp;<SELECT Name="mdmPVBFilterColumns" id="mdmPVBFilterColumns" onchange="mdm_SetFilterFields(this);mdm_ClearOnType(this);"></SELECT>

<SELECT Name="mdmPVBFilterOperator" id="mdmPVBFilterOperator" OnChange="mdm_SetFilterFieldsOperator(document.getElementById('mdmPVBFilterColumns'));"></SELECT>

<INPUT style="font-size: 10px;" Name="mdmPVBFilter" id="mdmPVBFilter" Type="Text" Size="18">&nbsp;<INPUT style="font-size: 10px;" id="mdmPVBFilter2" Name="mdmPVBFilter2" Type="Text" Size="18">&nbsp;
<BUTTON Class='clsSmallButton' Name='mdmPVBFilterButtonGo' id="mdmPVBFilterButtonGo" OnClick='mdm_RefreshDialog(this);'><MDMLABEL Name='GO_TOOL_TIP'></MDMLABEL></BUTTON>&nbsp;
<BUTTON Class='clsSmallButton' Name='mdmPVBFilterButtonReset' id="mdmPVBFilterButtonReset" OnClick='mdm_RefreshDialog(this);'><MDMLABEL Name='RESET_TOOL_TIP'></MDMLABEL></BUTTON>
#MDMEndIf
<TD nowrap BACKGROUND="/mdm/internal/images/toolbar/toolbarTile.gif" ALIGN=RIGHT BGCOLOR="SILVER">
<img src="/mdm/internal/images/toolbar/toolbarRightCap.gif" width=5 height=32  border="0"></TD>

</TR></TABLE>
<INPUT Name="mdmPvbPageIndex" id="mdmPvbPageIndex" Type="Hidden" Value="[PAGE_INDEX]">
<INPUT Name="mdmPvbMaxPage" id="mdmPvbMaxPage" Type="Hidden" Value="[MAX_PAGE]">
<!-- TOOLBAR END -->

<SCRIPT language="javascript">
  //Populate the page selection drop down
  document.all.mdmPvbPageSelect.length=0;
  
  //Adjust width of select drop down for large page numbers
  var iSelectWidth
  iSelectWidth = (("" + document.all.mdmPvbPageIndex.value).length * 5)+26;
  if (iSelectWidth<40)
    iSelectWidth = 40;
  document.all.mdmPvbPageSelect.style.width=''+iSelectWidth+'px';
  
  if (document.all.mdmPvbMaxPage.value<1000)
  {
    var tempOptions
    tempOptions = document.all.mdmPvbPageSelect.options
    for (var i=1; i<= document.all.mdmPvbMaxPage.value;i++){  
        tempOptions[i-1] = new Option(i,i);
    }      
    document.all.mdmPvbPageSelect.options[document.all.mdmPvbPageIndex.value-1].selected = true;
  }
  else
  {
    document.all.mdmPvbPageSelect.disabled=true;
    document.all.mdmPvbPageSelect.options[0] = new Option(document.all.mdmPvbPageIndex.value,document.all.mdmPvbPageIndex.value);;
    document.all.mdmPvbPageSelect.options[0].selected = true;
  }
  
  //Goto specified page
  function mdmPvbGotoPage(){
  
    //window.alert("mdmPvbGotoPage[" + document.all.mdmPvbPageSelect.selectedIndex + "]");

    // The trick here is to pass 2 query string value in the strAction = GotoPage and mdmGotoPage    
    mdm_PVBPageEventRaiser("GotoPage" ,(document.all.mdmPvbPageSelect.selectedIndex+1));
    
    //    window.location="[HTTP_ASP_FILE]?mdmPageAction=GotoPage&mdmGotoPage=" + (document.all.mdmPvbPageSelect.selectedIndex+1) + "&mdmPageIndex=[PAGE_INDEX]";
  }

  #MDMIf MDM_PVB_FILTER_MULTI_COLUM_MODE
      // Show or Hide the second filter combo box according which property is selected by default in the combo box  
      mdm_SetFilterFields(document.all.mdmPVBFilterColumns); 
  #MDMEndIf

// Loop around the mdmPVBFilterOperator options to find the one that matches the one
// in MDM_FILTER_OPERATOR_SAVE and set it as selected.
if(document.all.mdmPVBFilterOperator)
{
  for(var k = 0; k < document.all.mdmPVBFilterOperator.length; k++)
  {
   if(document.all.mdmPVBFilterOperator[k].value == "[MDM_FILTER_OPERATOR_SAVE]")
   {
     document.all.mdmPVBFilterOperator[k].selected = true;
   }
   else
   {
     document.all.mdmPVBFilterOperator[k].selected = false;
   }
  }   
  mdm_SetFilterFieldsOperator(document.all.mdmPVBFilterColumns);
 } 
   
</SCRIPT>

