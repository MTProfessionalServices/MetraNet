 <% 
' ---------------------------------------------------------------------------------------------------------------------------------------
'  @doc $Workfile: $
' 
'  Copyright 1998,2000 by MetraTech Corporation
'  All rights reserved.
' 
'  THIS SOFTWARE IS PROVIDED "AS IS", AND MetraTech Corporation MAKES
'  NO REPRESENTATIONS OR WARRANTIES, EXPRESS OR IMPLIED. By way of
'  example, but not limitation, MetraTech Corporation MAKES NO
'  REPRESENTATIONS OR WARRANTIES OF MERCHANTABILITY OR FITNESS FOR ANY
'  PARTICULAR PURPOSE OR THAT THE USE OF THE LICENSED SOFTWARE OR
'  DOCUMENTATION WILL NOT INFRINGE ANY THIRD PARTY PATENTS,
'  COPYRIGHTS, TRADEMARKS OR OTHER RIGHTS.
' 
'  Title to copyright in this software and any associated
'  documentation shall at all times remain with MetraTech Corporation,
'  and USER agrees to preserve the same.
' 
'  Created by: F.Torres
' 
'  $Date: 5/11/00 12:00:08 PM$
'  $Author: $
'  $Revision: 1$
'
' - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
'
' CLASS       : DefaultPVBPaymentAuditTable.asp
' DESCRIPTION : Browse the payment server table t_payment_audit! We directly run a SQL query no product view is involve.
' ---------------------------------------------------------------------------------------------------------------------------------------
Option Explicit
%>
<!-- #INCLUDE FILE="../../auth.asp" -->
<!-- #INCLUDE FILE="../../default/lib/momLibrary.asp"                   -->
<!-- #INCLUDE VIRTUAL="/mdm/mdmIncludes.asp" -->

<html>
  <head>
    <title>MetraTech Operations Menu</title>

    <link rel="stylesheet" href="../../default/localized/en-us/styles/styles.css">
    <link rel="stylesheet" href="../../default/localized/en-us/styles/DialogStyles.css">
      
    <!-- Includes for the menu -->  
    <script type="text/javascript" src="shared/mtmcode.js">
    </script>
    
    <script type="text/javascript">
      // Morten's JavaScript Tree Menu
      // written by Morten Wang <morten@treemenu.com> (c) 1998-2000
      // This is version 2.2.6, dated 2000-03-30
  
      // The script is freely distributable
      // It may be used (and modified) as you wish, but retain this message
      // For more information about the menu visit its home page
      // http://www.treemenu.com/
  
      /******************************************************************************
      * User-configurable options.                                                  *
      ******************************************************************************/
  
      // Menu table width, either a pixel-value (number) or a percentage value.
      var MTMTableWidth = "100%";
      
      // Name of the frame where the menu is to appear.
      var MTMenuFrame = "fmeNavBar";
      
      // variable for determining whether a sub-menu always gets a plus-sign
      // regardless of whether it holds another sub-menu or not
      var MTMSubsGetPlus = true;
      
      // variable that defines whether the menu emulates the behaviour of
      // Windows Explorer
      var MTMEmulateWE = false;
      
      // Directory of menu images/icons
      var MTMenuImageDirectory = "/mom/default/localized/en-us/images/menu/";
      
      // Variables for controlling colors in the menu document.
      // Regular BODY atttributes as in HTML documents.
      // var MTMBGColor = "#ffffee";

      var MTMBGColor = "#ffffee" //#EFEFE7"
      var MTMBackground = "";
      var MTMTextColor = "#000000";
      
      // color for all menu items
      var MTMLinkColor = "#330099";
      
      // Hover color, when the mouse is over a menu link
      var MTMAhoverColor = "#990000";
      
      // Foreground color for the tracking & clicked submenu item
      var MTMTrackColor ="#000000";
      var MTMSubExpandColor = "#666699";
      var MTMSubClosedColor = "#666699";
      
      // All options regarding the root text and it's icon
      var MTMRootIcon = "menu_new_root.gif";
      
      <%
        response.write "var MTMenuText = """ & request.ServerVariables("SERVER_NAME") & """" & vbNewline
      %>
      var MTMRootColor = "#000000";
      var MTMRootFont = "Arial, Helvetica, sans-serif";
      var MTMRootCSSize = "84%";
      var MTMRootFontSize = "-1";
      
      // Font for menu items.
      var MTMenuFont = "Arial, Helvetica, sans-serif";
      var MTMenuCSSize = "84%";
      var MTMenuFontSize = "-1";
      
      // Variables for style sheet usage
      // 'true' means use a linked style sheet.
      var MTMLinkedSS = false;
      var MTMSSHREF = "../../default/localized/en-us/styles/MenuStyles.css";
      
      // Whether you want an open sub-menu to close automagically
      // when another sub-menu is opened.  'true' means auto-close
      var MTMSubsAutoClose = false;
      
      // This variable controls how long it will take for the menu
      // to appear if the tracking code in the content frame has
      // failed to display the menu. Number if in tenths of a second
      // (1/10) so 10 means "wait 1 second".
      var MTMTimeOut = 15;
      
      // Added to base code
      var MTMIconWidth = 18;
      var MTMIconHeight = 18;
      
      /******************************************************************************
      * User-configurable list of icons.                                            *
      ******************************************************************************/
      
      var MTMIconList = null;
      MTMIconList = new IconList();
      MTMIconList.addIcon(new MTMIcon("menu_link_external.gif", "http://", "pre"));
      MTMIconList.addIcon(new MTMIcon("menu_link_pdf.gif", ".pdf", "post"));
    </script>

    <script language="JavaScript1.2">
    <% DrawMenu %>
    </script>
    
<%
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' DrawMenu() -- Draw the menu on the screen
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' ---------------------------------------------------------------------------------------------------------------------------------------
' FUNCTION      : GetXMLMenuFileName
' PARAMETERS    :
' DESCRIPTION   : Return main xml menu file. Test if the MOM is intalled on the MPM Machine or the Payment Server Machine
' RETURNS       :
PRIVATE FUNCTION GetXMLMenuFileName() ' As String
    GetXMLMenuFileName  = server.MapPath(session("VIRTUAL_DIR") & mom_GetMenuName())
END FUNCTION

Sub DrawMenu()

  Dim objMenuGroup
  Dim objCreator
  Dim objCheckIn, objCheckOut, objDeploy
  Dim strUsername, strPassword
  
  '''''''''''''''''''''''''''''
  ' Active Configuration Menu
  Set objCreator    = Server.CreateObject("MTAdminNavbar.MenuCreator")
  Set objMenuGroup  = ObjCreator.GetMenu(CStr(GetXMLMenuFileName()), "MetraTech Operations Manager", "", mid(session("VIRTUAL_DIR"), 2), server.MapPath(session("VIRTUAL_DIR")))
'  Set objMenuGroup =  ObjCreator.getMenu(server.MapPath(session("VIRTUAL_DIR") & "\us\menu.xml"),           "Rule Files",                   "", "RuleEditor", server.MapPath(session("VIRTUAL_DIR")))  

  '''''''''''''''''''''''''''''''''''''
  ' Create the top-level menu items   '
  '''''''''''''''''''''''''''''''''''''
  response.write "  var menu = null;" & vbNewline
  response.write "  menu = new MTMenu();" & vbNewline
  
  'System Quick View
  'response.write "  menu.MTMAddItem(new MTMenuItem(""System Quick View"",""/mom/default/dialog/SystemInformation/AllInformation.asp"", ""fmeMain""));" & vbNewline
  'response.write "  menu.MTMAddItem(new MTMenuItem(""Blank"","""", ""fmeMain""));" & vbNewline

  'Namespaces
  'response.write "  menu.MTMAddItem(new MTMenuItem(""Namespaces"",""/mom/default/dialog/DefaultDialogPVBNameSpace.asp"", ""fmeMain""));" & vbNewline
  
  if Not objMenuGroup is Nothing then
    WriteMenuGroup "menu", objMenuGroup
  end if
End Sub

'----------------------------------------------------------------------------
' WriteMenuGroup -- Write the Active Configuration Menu
'----------------------------------------------------------------------------
Sub WriteMenuGroup(strMenu, objMenuGroup)
  Dim objMenuItem
  Dim strNewMenuName
  Dim i
  
  i = 0
  
  for each objMenuItem in objMenuGroup.All

    If TypeName(objMenuItem) = "MTAdminMenuGroup" Then
      strNewMenuName = strMenu & i
      response.write "  var " & strNewMenuName & " = null;" & vbNewline
      response.write "  " & strNewMenuName & " = new MTMenu();" & vbNewline
      WriteMenuGroup strNewMenuName, objMenuItem
    end if

'    response.write i & vbNewline & " : " & objMenuItem.name
    i = i + 1
  next
 
 
  i = 0
  
  for each objMenuItem in objMenuGroup.All
 
    if TypeName(objMenuItem) = "MTAdminMenuGroup" Then
      strNewMenuName = strMenu & i
      response.write "  " & strMenu & ".MTMAddItem(new MTMenuItem(""" & objMenuItem.name & """));"  & vbNewline
      response.write "  " & strMenu & ".items[" & i & "].MTMakeSubmenu(" & strNewMenuName & ");" & vbNewline  ''Add one to offset
    elseif TypeName(objMenuItem) = "MTAdminMenuItem" Then
      response.write "  " & strMenu & ".MTMAddItem(new MTMenuItem(""" & objMenuItem.name & """,""" & objMenuItem.link & """, """ & objMenuItem.target & """));" & vbNewline
    end if

    i = i + 1   
    
 next
  
End Sub
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
%>

  
  
  <script language="JavaScript1.2">
  //This is necessary for IE4, which crashes if one frame calls the document.close() for
  // another frame.  If the doc is not closed, the menu never appears and is not redrawn
  // correctly.
    var intIntervalID;
  
  
    function StartMenu() {
      MTMStartMenu();
    
      if(MTMIE4)
        intIntervalID = setInterval('MTMReload();', 500)
    }
  </script>

  </head>

  <body onload="StartMenu()"  bgcolor="#EFEFE7">
  </body>

</html>





