<WinPropertiesInfo Version="9/22/2010"
                  DoMonitorPerformance="false"
                  DoActionLog="true"
                  ActionLogTarget="File"
                  UseRelativeActionLogPath="true"
                  ActionLogPath="Logs/WinActions/Default"
                  DoSysLog="true"
                  SysLogTarget="File"
                  UseRelativeSysLogPath="true"
                  SysLogPath="Logs/WinSystem/Default"
                  SysLogLevel="Trace"
                  IgnoreAspNetValidation="true"
                  HideAspNetExceptions="true"
                  DoGlobalDisable="false"
                  ProcessAuthenticatedOnly="true">
	<Processors>
		<Processor Id="1CFD560B-35C5-4950-BF00-1C3511C961BE" StopOnError="true">
			<Qualifier AppPath="/MetraNet" UseResourceQualifiers="true" ExcludeResourceMode="true">
				<Extensions>
					<item value=".aspx"/>
					<item value=".asp"/>
					<item value=".asmx"/>
					<item value=".axd"/>
				</Extensions>
				<Resources>
					<item value="/MetraNet/Default.aspx" />
				</Resources>
			</Qualifier>

			<CommonRules>
				<CommonRule Id="RR.1" Subsystem="RequestScreener" Engine="Input.Default"/>
			</CommonRules>

			<RequestRules>
				<RequestRule Id="CR.1" Subsystem="Detector" Engine="Sql.Default"/>
				<RequestRule Id="CR.2" Subsystem="Detector" Engine="Xss.V2"/>
			</RequestRules>

			<CommonFormRules>
				<CommonFormRule Id="CR.3" Subsystem="Detector" Engine="Sql.Default"/>
				<CommonFormRule Id="CR.4" Subsystem="Detector" Engine="Xss.V2"/>
			</CommonFormRules>

			<ResourceRules>
				<!-- Sample configuration -->
				<ResourceRule Resource="/MyDir/XMLValidatorTest.aspx" UseFirst="true">
					<ParamRules>
						<ParamRule Param="ctl00$MainContent$TextBoxXML" Exclude="true"/>
					</ParamRules>
				</ResourceRule>

				<ResourceRule Resource="/MyDir/AnotherTest.aspx" UseFirst="false">
					<ParamRules>

						<ParamRule Param="Test">
							<Rule Id="RS.1" Subsystem="Validator" Engine="BasicString.Def"/>
						</ParamRule>

						<ParamRule Param="Attack">
							<Rule Id="RS.2" Subsystem="Detector" Engine="Xss.V2"/>
						</ParamRule>

					</ParamRules>
				</ResourceRule>

				<ResourceRule Resource="/MyDir/XMLValidatorTest.aspx" UseFirst="false">
					<!--ParamRules>
            <ParamRule Param="ctl00$MainContent$TextBoxXML">
              <Rule Id="RS.3" Subsystem="Validator" Engine="XMLString.Default"/>
            </ParamRule>
          </ParamRules-->
				</ResourceRule>

				<ResourceRule Resource="/MyDir/DirectoryTraversalTest.aspx" UseFirst="false">
					<ParamRules>

						<!--ParamRule Param="ctl00$MainContent$txtDirectoryPath'">
              <Rule Id="DT.2" Subsystem="Detector" Engine="DirectoryTraversal.Default"/>
            </ParamRule-->

						<!--ParamRule Param="ctl00$MainContent$txtDirectoryPath'">
              <Rule Id="DT.1" Subsystem="Validator" Engine="PatternString.Standard.DirectoryTraversal"/>
            </ParamRule-->

					</ParamRules>
				</ResourceRule>

			</ResourceRules>

			<RuleActions>
				<ActionRule Name="Log" />
				<ActionRule Name="BlockOperation" />
			</RuleActions>
		</Processor>
		<Processor Id="CE0A6C7D-3B56-429C-A1B8-60147107FC0A" StopOnError="true">
			<Qualifier AppPath="/MetraView" UseResourceQualifiers="true" ExcludeResourceMode="true">
				<Extensions>
					<item value=".aspx"/>
					<item value=".asp"/>
					<item value=".asmx"/>
					<item value=".axd"/>
				</Extensions>
				<Resources></Resources>
			</Qualifier>

			<CommonRules>
				<CommonRule Id="RR.1" Subsystem="RequestScreener" Engine="Input.Default"/>
			</CommonRules>

			<RequestRules>
				<RequestRule Id="CR.1" Subsystem="Detector" Engine="Sql.Default"/>
				<RequestRule Id="CR.2" Subsystem="Detector" Engine="Xss.V2"/>
			</RequestRules>

			<CommonFormRules>
				<CommonFormRule Id="CR.3" Subsystem="Detector" Engine="Sql.Default"/>
				<CommonFormRule Id="CR.4" Subsystem="Detector" Engine="Xss.V2"/>
			</CommonFormRules>

			<ResourceRules></ResourceRules>

			<RuleActions>
				<ActionRule Name="Log" />
				<ActionRule Name="BlockOperation" />
			</RuleActions>
		</Processor>
		<Processor Id="4E6829C8-76B6-4FD4-8284-2BA29BA25EEB" StopOnError="true">
			<Qualifier AppPath="/" UseResourceQualifiers="true" ExcludeResourceMode="true">
				<Extensions>
					<item value=".asp"/>
				</Extensions>
				<Resources></Resources>
			</Qualifier>

			<CommonRules>
				<CommonRule Id="RR.1" Subsystem="RequestScreener" Engine="Input.Default"/>
			</CommonRules>

			<RequestRules>
				<RequestRule Id="CR.1" Subsystem="Detector" Engine="Sql.Default"/>
				<RequestRule Id="CR.2" Subsystem="Detector" Engine="Xss.V2"/>
			</RequestRules>

			<CommonFormRules>
				<CommonFormRule Id="CR.3" Subsystem="Detector" Engine="Sql.Default"/>
				<CommonFormRule Id="CR.4" Subsystem="Detector" Engine="Xss.V2"/>
			</CommonFormRules>

			<ResourceRules>
				<ResourceRule Resource="/mcm/default/dialog/Counters.ViewEdit.asp" UseFirst="true">
					<ParamRules>
						<ParamRule Param="EditCounter" Exclude="true"/>
					</ParamRules>
				</ResourceRule>

        <!-- CORE-6237 a port of ESR-5928 from 6.8.0 to latest, exclude the "OK" button from being checked by the security framework -->
        <ResourceRule Resource="/MOM/default/dialog/BackOutRerun.BackoutStep1.asp" UseFirst="true">
          <ParamRules>
            <ParamRule Param="OK" Exclude="true"/>
          </ParamRules>
        </ResourceRule>

			</ResourceRules>

			<RuleActions>
				<ActionRule Name="Log" />
				<ActionRule Name="BlockOperation" />
			</RuleActions>
		</Processor>
	</Processors>
</WinPropertiesInfo>