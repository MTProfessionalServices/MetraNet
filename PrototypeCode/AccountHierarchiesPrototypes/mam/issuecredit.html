<HTML>
<HEAD>
<LINK rel='STYLESHEET' type='text/css' href='/mam/default/localized/us/styles/Grid.css'>
<LINK rel='STYLESHEET' type='text/css' href='/mam/default/localized/us/styles/MAMMenu.css'>
<LINK rel='STYLESHEET' type='text/css' href='/mam/default/localized/us/styles/RuleEditor_styles.css'>
<LINK rel='STYLESHEET' type='text/css' href='/mam/default/localized/us/styles/styles.css'>
<LINK rel='STYLESHEET' type='text/css' href='/mam/default/localized/us/styles/tab_styles.css'>

<!-- Meta Tag from dictionary -->
<META http-equiv="Content-Type" content="text/html" charset="iso-8859-1">

                                                                                                               
</HEAD>
<BODY>
<FORM Method="post" Action="/mam/default/dialog/DefaultDialogIssueCredit.asp"  name='mdm'>
<!-- MDM Client Side -->
<SCRIPT language="JavaScript" src="/mdm/internal/mdm.JavaScript.lib.js"></SCRIPT>
<SCRIPT LANGUAGE="JavaScript1.2">
// MetraTech Dialog Manager Client Side. This JavaScript was generated.
var DECIMAL_SEPARATOR	                        =	".";  // Should be replaced by . or ,
var THOUSAND_SEPARATOR	                      =	",";	// Should be replaced by . or ,
var DECIMAL_DIGIT_BEFORE                      =  10;
var DECIMAL_DIGIT_AFTER                       =  2;
var MDM_CLIENT_SIDE_SUPPORT_ENTER_KEY         =  true; // PVB Does not support enter key and escape key
var MDM_REQUEST_QUERYSTRING                   =  ""; // PVB Does not support enter key and escape key
var MDM_REQUEST_FORM                          =  ""; // PVB Does not support enter key and escape key

var MDM_PICKER_PARAMETER_VALUE                = "[MDM_PICKER_PARAMETER_VALUE]"; // MDM V2 Picker Support
var MDM_PICKER_NEXT_PAGE                      = "[MDM_PICKER_NEXT_PAGE]";

var MDM_ENTER_KEY_PRESSED                     = false; // Monitor the status of the enter key to avoid to send it twice

function GetMaxLength(strName){
    if(strName){
	    if(strName.toUpperCase()=="AUTO"){ return 1;}
	    if(strName.toUpperCase()=="CREDITTIME"){ return 0;}
	    if(strName.toUpperCase()=="STATUS"){ return 20;}
	    if(strName.toUpperCase()=="REQUESTID"){ return 0;}
	    if(strName.toUpperCase()=="CONTENTIONSESSIONID"){ return 50;}
	    if(strName.toUpperCase()=="_ACCOUNTID"){ return 0;}
	    if(strName.toUpperCase()=="_AMOUNT"){ return 18;}
	    if(strName.toUpperCase()=="_CURRENCY"){ return 3;}
	    if(strName.toUpperCase()=="EMAILNOTIFICATION"){ return 1;}
	    if(strName.toUpperCase()=="EMAILADDRESS"){ return 50;}
	    if(strName.toUpperCase()=="EMAILTEXT"){ return 255;}
	    if(strName.toUpperCase()=="ISSUER"){ return 80;}
	    if(strName.toUpperCase()=="REASON"){ return 80;}
	    if(strName.toUpperCase()=="OTHER"){ return 255;}
	    if(strName.toUpperCase()=="INVOICECOMMENT"){ return 255;}
	    if(strName.toUpperCase()=="INTERNALCOMMENT"){ return 255;}
	    if(strName.toUpperCase()=="ACCOUNTINGCODE"){ return 10;}
	    if(strName.toUpperCase()=="RETURNCODE"){ return 0;}
	    if(strName.toUpperCase()=="REQUESTAMOUNT"){ return 18;}
	    if(strName.toUpperCase()=="CREDITAMOUNT"){ return 18;}
	    if(strName.toUpperCase()=="PAYER"){ return 128;}
	    if(strName.toUpperCase()=="NAMESPACE"){ return 40;}
	    if(strName.toUpperCase()=="RESOLVEWITHACCOUNTIDFLAG"){ return 0;}
	    if(strName.toUpperCase()=="CSRID"){ return 40;}
    }
    return 0;
}
function GetDataType(strName){
    if(strName){
	    if(strName.toUpperCase()=="AUTO"){ return "STRING";}
	    if(strName.toUpperCase()=="CREDITTIME"){ return "TIMESTAMP";}
	    if(strName.toUpperCase()=="STATUS"){ return "STRING";}
	    if(strName.toUpperCase()=="REQUESTID"){ return "INT32";}
	    if(strName.toUpperCase()=="CONTENTIONSESSIONID"){ return "STRING";}
	    if(strName.toUpperCase()=="_ACCOUNTID"){ return "INT32";}
	    if(strName.toUpperCase()=="_AMOUNT"){ return "DECIMAL";}
	    if(strName.toUpperCase()=="_CURRENCY"){ return "STRING";}
	    if(strName.toUpperCase()=="EMAILNOTIFICATION"){ return "STRING";}
	    if(strName.toUpperCase()=="EMAILADDRESS"){ return "STRING";}
	    if(strName.toUpperCase()=="EMAILTEXT"){ return "STRING";}
	    if(strName.toUpperCase()=="ISSUER"){ return "STRING";}
	    if(strName.toUpperCase()=="REASON"){ return "STRING";}
	    if(strName.toUpperCase()=="OTHER"){ return "STRING";}
	    if(strName.toUpperCase()=="INVOICECOMMENT"){ return "STRING";}
	    if(strName.toUpperCase()=="INTERNALCOMMENT"){ return "STRING";}
	    if(strName.toUpperCase()=="ACCOUNTINGCODE"){ return "STRING";}
	    if(strName.toUpperCase()=="RETURNCODE"){ return "INT32";}
	    if(strName.toUpperCase()=="REQUESTAMOUNT"){ return "DECIMAL";}
	    if(strName.toUpperCase()=="CREDITAMOUNT"){ return "DECIMAL";}
	    if(strName.toUpperCase()=="PAYER"){ return "STRING";}
	    if(strName.toUpperCase()=="NAMESPACE"){ return "STRING";}
	    if(strName.toUpperCase()=="RESOLVEWITHACCOUNTIDFLAG"){ return "BOOLEAN";}
	    if(strName.toUpperCase()=="CSRID"){ return "STRING";}
    }
	  return "STRING";
}
function BrowserCheck(){

   var b 	=	navigator.appName

   if(b=="Netscape")this.b = "ns"
   else if(b=="Microsoft Internet Explorer")this.b = "ie"
   else this.b = b;

   this.v = parseInt(navigator.appVersion);
   this.ns = (this.b=="ns" && this.v>=4);
   this.ns4 = (this.b=="ns" && this.v==4);
   this.ns5 = (this.b=="ns" && this.v==5);
   this.ie = (this.b=="ie" && this.v>=4);
   this.ie4 = (navigator.userAgent.indexOf('MSIE 4')>0);
   this.ie5 = (navigator.userAgent.indexOf('MSIE 5')>0);
   if (this.ie5) this.v = 5;
   this.min = (this.ns||this.ie);
}
function IsNetscape(){
  objBrowser = new BrowserCheck();
  return(objBrowser.ns);
}
function HookNewEvents(){
  if(IsNetscape()){
	    document.captureEvents(Event.KEYPRESS);
    	document.onkeypress = CustomKeyManager;
  }
  else{
    	document.onkeypress = CustomKeyManager; // Microsoft IEX
  }
  return true;
}
function CheckChar(string, strGoodChars) {
    if (!string) return false;

    for (var i = 0; i < string.length; i++) {
       if (strGoodChars.indexOf(string.charAt(i)) == -1)return false;          
    }
    return true;
}
function GetCustomKey(e){
	if(IsNetscape()){
		return e.which;
	}
	else{
		return window.event.keyCode;
	}
}
function CancelKey(){
	if(IsNetscape()){
		return false; // Must return false for Netscape to cancel the char
	}
	else{
		window.event.keyCode=0;
	}
}
function CanAddThisCharAsDecimalSeparator(strValue,strChar) {	
	return (strValue.indexOf(strChar) == -1); // Yes only is the char is not there
}
function CustomKeyManager(objEvent){
	var strS, objE, obj, strObjName, lngMaxLen, strObjDataType, strObjName, strObjType, strObjValue, lngKey, strKey, DecimalLocation;  				
	if(IsNetscape()){
  		objE		    =	objEvent;
  		obj		      =	objEvent;
  		strObjName	=	objEvent.target.name
  		strObjType	=	obj.target.type;
  		strObjValue	= obj.target.value;
	}
	else{
  		obj 		    = 	window.event.srcElement;
  		strObjName	= 	obj.name;
  		strObjType	= 	obj.type;
  		strObjValue	= 	obj.value;
	}    
  if(!strObjName){            // Test if the name is valid, is not that mean the object is not valid that's mean that there is not control selected
      return CancelKey(); 		//  The key is camcel! Return false to cancel the char
  }    
	lngMaxLen 		= 	GetMaxLength(strObjName);
	strObjDataType= 	GetDataType(strObjName);
	lngKey			  = 	GetCustomKey(objE);

	if(lngKey==8) return true; 			// Always accept backspace	 
  
  if((lngKey==13)&&(MDM_CLIENT_SIDE_SUPPORT_ENTER_KEY)){  // check for enter key and submit form
  
      if(strObjName.toUpperCase()=="MDMPVBFILTER"){
          document.mdm.mdmProperty.value = "mdmPVBFilterButtonGo";
          document.mdm.submit();
          return CancelKey();
      }
      else{
        if(MDM_ENTER_KEY_PRESSED){  
            return CancelKey(); // Cancel the enter key it is was already entered
        }
        else{            
            MDM_ENTER_KEY_PRESSED = true;
            document.mdm.mdmAction.value = "ENTERKEY"; 
            document.mdm.submit();
          	return CancelKey();
        }
      }
  }  
  if((lngKey==27)&&(MDM_CLIENT_SIDE_SUPPORT_ENTER_KEY)){  // check for escape key and submit form
      document.mdm.mdmAction.value = "ESCAPEKEY"; 
      document.mdm.submit();
    	return CancelKey();
  }
	if(strObjType.toUpperCase() == "TEXTAREA"){ 	// Check the MaxLen for TextArea			
		  if((strObjValue.length>=lngMaxLen)&&(lngMaxLen>0))return CancelKey(); 	//  Return false to cancel the char
	}  
	if((strObjDataType=="DECIMAL")||(strObjDataType=="FLOAT")||(strObjDataType=="DOUBLE")){ // Check if char is allowed
  
  		strKey = String.fromCharCode(lngKey); // is it a valid number
  		if(!CheckChar(strKey,"0123456789"+DECIMAL_SEPARATOR+THOUSAND_SEPARATOR)){  
  			  return CancelKey(); 		//  The key is camcel! Return false to cancel the char
  		}
  		else{
    			if(strKey==DECIMAL_SEPARATOR){ // The key is accepted but test if the char decimal separator is not already there          
    				if(!CanAddThisCharAsDecimalSeparator(strObjValue,strKey)){            
    					  return CancelKey(); 		//  The key is camcel! Return false to cancel the char
    				}
          }          
          if(CanAddThisCharAsDecimalSeparator(strObjValue,DECIMAL_SEPARATOR) && (strKey!=DECIMAL_SEPARATOR)){ // Fix so decimal will not overflow and only 2 decimal places          
              if((strObjValue.length>=DECIMAL_DIGIT_BEFORE))return CancelKey(); 	//  Return false to cancel the char
          }
          else{            
            DecimalLocation = strObjValue.indexOf(DECIMAL_SEPARATOR)  
            if(DecimalLocation != -1){
               if(strObjValue.length > DecimalLocation + DECIMAL_DIGIT_AFTER){  // number of decimal places to allow
                  return CancelKey();
               }
            }
          }
       }
  }
	if((strObjDataType=="INT32")){	
		  if(!CheckChar(String.fromCharCode(lngKey),"0123456789"))return CancelKey(); //  Return false to cancel the char
	}	
	if((strObjDataType=="STRINGID")){	
		  if(!CheckChar(String.fromCharCode(lngKey),"_ ABCDEFGHIJKLMNOPQRSTVWUXYZabcdefghijklmnopqrstvwuxyz0123456789"))return CancelKey(); //  Return false to cancel the char
	}	  
  if((strObjDataType=="TIMESTAMP")){	
      // 6/12/2001 4:46:41 PM
      // /0612/2001 12:00:00 AM
      strKey = String.fromCharCode(lngKey);
      if(!CheckChar(strKey,"0123456789/:APMapm ")) {
        return CancelKey(); //  Return false to cancel the char
      }  
	}	
}
HookNewEvents();
function mdm_RefreshDialog(varPropertyNameOrObject){  
	document.mdm.mdmAction.value    = 'Refresh';
  if(typeof varPropertyNameOrObject == 'object'){ // MDMV2 - This function support now string or object  
      var strName = varPropertyNameOrObject.name;           
      if(strName.toUpperCase()=="OK"){
          document.mdm.mdmAction.value = "ENTERKEY";
      }
      else{
          if(strName.toUpperCase()=="CANCEL"){
              document.mdm.mdmAction.value = "ESCAPEKEY";
          }
          else{
              document.mdm.mdmProperty.value = strName;
          }
      }
  }
  else{ // MDMV1
      if(varPropertyNameOrObject!=null){ // In very rare case of MDM V1.3 the parameter could have been not defined!
        document.mdm.mdmProperty.value = varPropertyNameOrObject;
      }
  }
	document.mdm.submit();
}

function mdm_RefreshDialogUserCustom(varPropertyNameOrObject,strUserCustom){  
    document.mdm.mdmUserCustom.value = strUserCustom;
    mdm_RefreshDialog(varPropertyNameOrObject);
}

function mdm_GetComboBoxValue(strForm, strElement){
  var i, intLen;
  if(eval('document.' + strForm + '.' + strElement) != null) { //Check for the form element to exist
    intLen = eval('document.' + strForm + '.' + strElement + '.length');
    if(intLen != null ) {
      for(i=0; i < intLen; i++) {
        if(eval('document.' + strForm + '.' + strElement + '.options[' + i + '].selected') == true)
          return(eval('document.' + strForm + '.' + strElement + '.options[' + i + '].value'));
      }
    }
  }
  return(''); //unable to get the index
}

function mdm_RefreshCaller(strParameters,strRouteToParameters){

    var strOpenerURL, strTmpChar;
    
    strOpenerURL            = ''+window.opener.location;
    strOpenerURL            = AddToQueryString(strOpenerURL,'mdmAction=Refresh&mdmReload=FALSE&mdmRefreshFromPopUpDialog=TRUE');
    
    if(strParameters.length){
    
        strOpenerURL = AddToQueryString(strOpenerURL,strParameters);
    }
    if(strRouteToParameters.length){
    
        strOpenerURL = AddToQueryString(strOpenerURL,strRouteToParameters);
    }    
    window.opener.location  = strOpenerURL;
}
function mdm_CloseWindow(){
    window.close();
}
function mdm_RefreshCallerAndCloseWindow(strParameters,strRouteToParameters){
    mdm_RefreshCaller(strParameters,strRouteToParameters);
    mdm_CloseWindow();
}
function mdm_Initialize(){ // Some Customizable Javascript associate to the form Form.JavaScriptInitialize    
    
    return true;
}
mdm_Initialize();
</SCRIPT>
<INPUT Name="mdmAction" Type="Hidden" Value=""><INPUT Name="mdmProperty" Type="Hidden" Value=""><INPUT Name="mdmUserCustom" Type="Hidden" Value="">


<TABLE border="0" cellpadding="1" cellspacing="0" width="100%">
<tr>
    <td Class='CaptionBar' nowrap>Issue Credit&nbsp;</td>
</tr>
</TABLE>
<br>
<table width="100%"><tr><td align="center">
        <TABLE border="0" cellpadding="2" cellspacing="1">
          <tr> 
      <td class='captionEW'>Account ID:</td>
      <td class='fieldNonEditable'>123</td>
    </tr>
    <tr> 
      <td class='captionEW'>{NL}Reason: 
      </td>
      <td class='clsStandardText'> 
        <SELECT name="Reason" size="1" Class='field'>
<!-- Enum Type Reason PropertyValue=DROPPEDCALL -->
<OPTION Value="DroppedCall" SELECTED>Dropped Call</OPTION>

<OPTION Value="PoorConnection">Poor Connection</OPTION>

<OPTION Value="BadService">Bad Service</OPTION>

<OPTION Value="GeneralDissatisfaction">General Dissatisfaction</OPTION>

<OPTION Value="Other">Other</OPTION>


        </select>
      </td>
    </tr>
    <tr> 
      <td class='captionEW'>{NL}Other:</td>
      <td class='clsStandardText'> 
        <INPUT Value=""  MaxLength="255"  class='field' Type="text" size="60" name="Other">
      </td>
    </tr>
    <tr> 
            <td class='captionEW' style="vertical-align: top;">{NL}InvoiceComment:</td>
      <td> 
        <TEXTAREA class='field'  name="InvoiceComment" rows="4" cols="60"></textarea>
      </td>
    </tr>
    <tr> 
      <td class='captionEWRequired'>Amount 
        (USD): </td>
      <td> 
        <INPUT Value=""  MaxLength="18"  class='fieldRequired'   type="text" size="60" name="_Amount"></td>
    </tr>
    <!--
<tr>
    <td>&nbsp;</td>
    <td class='clsStandardText'>{NL}Status: </td>
    <td class='clsStandardText'>Approved<INPUT Value="APPROVED"  Type='Hidden' Name='Status'></td>
</tr>
-->
    <tr> 
            <td class='captionEW' style="vertical-align: top;">{NL}InternalComment:</td>
      <td class='clsStandardText'> 
        <TEXTAREA class='field'  name="InternalComment" rows="4" cols="60"></textarea>
      </td>
    </tr>
    <tr> 
      <td class='captionEW'>{NL}AccountingCode:</td>
      <td class='clsStandardText'> 
        <INPUT Value=""  MaxLength="10"  class='field'   type="text" size="60" name="AccountingCode">
      </td>
    </tr>
    <tr> 
      <td class="captionEW">{NL}EmailNotification:</td>
      <td class='clsStandardText'> 
        <INPUT Type="CheckBox" name="EmailNotification"><INPUT Type="Hidden" Value="1" Name="mdm_CheckBox_EmailNotification" > 
        </td>
    </tr>
    <tr> 
      <td class='captionEW'>{NL}EmailAddress:</td>
      <td class='clsStandardText'> 
        <INPUT Value=""  MaxLength="50"  class='field'   type="text" size="60" name="EmailAddress">
      </td>
    </tr>
    <tr> 
            <td class='captionEW' style="vertical-align: top;">{NL}EmailText:</td>
      <td class='clsStandardText'> 
        <TEXTAREA class='field'  name="EMailText" rows="4" cols="60"></textarea>
      </td>
    </tr>
	<tr>
      <TD align="center" colspan="2"><BR>
        <button onclick="mdm_RefreshDialog(this)" name="ok"     Class='clsOkButton'>OK</button> <button onclick="mdm_RefreshDialog(this)" name="cancel" Class='clsOkButton'>Cancel</button>
        </TD>
	</tr>
  </table>
</td></tr></table>
</FORM>
</BODY>
</HTML>