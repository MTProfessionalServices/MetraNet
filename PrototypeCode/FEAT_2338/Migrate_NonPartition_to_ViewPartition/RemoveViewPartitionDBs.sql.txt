select * from t_partition

-- Drop all partition views DB
PRINT('Drop partitioned view databases')

DECLARE partviewcur CURSOR FOR
	SELECT partition_name
	FROM t_partition 
	
DECLARE @partition_name VARCHAR(50)

OPEN partviewcur
FETCH NEXT FROM partviewcur INTO @partition_name
WHILE (@@FETCH_STATUS = 0)
BEGIN
	IF EXISTS(SELECT NAME FROM sys.databases WHERE NAME = @partition_name) 
	BEGIN
		EXEC ('DROP DATABASE ' + @partition_name)
		PRINT ('Database '+ @partition_name + ' was dropped.')
	END  
	FETCH NEXT FROM partviewcur INTO @partition_name
END

CLOSE partviewcur
DEALLOCATE partviewcur