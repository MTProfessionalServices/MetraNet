<xmlconfig>
  <mtconfigdata>

 <version ptype="INTEGER">1</version>
 <!-- First processor configuration -->
 <processor>
  <name>CalcDuration</name>
  <progid>MetraPipeline.MTSQLInterpreter.1</progid>
  <description>Calculates the difference in seconds between the StartTime and EndTime properties</description>

	<!--
  <autotest>
    <file>calcduration.xml</file>
  </autotest>
  -->

  <!-- Processor specific configuration data -->
  <configdata>
 
  <Program><![CDATA[
		
		CREATE PROCEDURE calcduration 
      @StartTime DATETIME 
      @EndTime DATETIME  
      @Duration INTEGER OUTPUT
		AS
			DECLARE @timeStartTime TIME;
			DECLARE @timeEndTime TIME;
			DECLARE @intStartTime INTEGER;
			DECLARE @intEndTime INTEGER;
			SET @timeStartTime = CAST (@StartTime AS TIME);
			SET @timeEndTime = CAST (@EndTime AS TIME);
			SET @intStartTime = CAST (@timeStartTime AS INTEGER);
			SET @intEndTime = CAST (@timeEndTime AS INTEGER);
			IF (@intEndTime < @intStartTime)
			BEGIN
					SET @Duration = 0;
					RETURN;
			END	
			SET @Duration = @intEndTime - @intStartTime;
	 
  ]]></Program> 
    
  </configdata>

 </processor>

  </mtconfigdata>

</xmlconfig>

