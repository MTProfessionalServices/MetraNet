<HTML>
<HEAD>
  <LINK localized="TRUE" rel="STYLESHEET" type="text/css" href="/mcm/default/localized/en-us/styles/styles.css">
  <LINK rel="STYLESHEET" type="text/css" href="/mcm/default/localized/en-us/styles/tab_styles.css">
  <title><MDMLABEL Name="TEXT_KEYTERM_RECURRING_CHARGE"></MDMLABEL></title>  
  <SCRIPT language="JavaScript" src="/mcm/default/lib/utilForm.js"></SCRIPT>
  <script language='javascript'>
	function updateProrationBasedOnField()
	{
		if (document.mdm.ProrateOnDeactivation.checked || document.mdm.ProrateOnActivation.checked || document.mdm.ProrateInstantly.checked)
		{
			disableDiv('ProrateOn',false);
		}
		else
		{
			disableDiv('ProrateOn',true);
		}
	}

	function disableDiv(sDivName,bDisable) {
		toggleDisabled(document.getElementById(sDivName), bDisable);
	}

	function toggleDisabled(el,bDisable) {
		if (el.disabled != null){
			el.disabled = bDisable;
		}
		
		if (el.style != null){
			el.style.color =  (bDisable) ? 'gray' : 'black';
		}
		
		if (el.childNodes && el.childNodes.length > 0) {
			for (var x = 0; x < el.childNodes.length; x++) {
				toggleDisabled(el.childNodes[x],bDisable);
			}
		}
	}

	function updateDeactivation()
	{
		if (document.mdm.ProrateOnUnsubscribeDate.checked)
		{
		  disableDiv('ProrateOnDeactivationDiv', false);
		  disableDiv('ProrateInstantlyDiv', false);
		  //Make prorate on deactivation the default if nothing is checked
		  if (!document.mdm.ProrateOnDeactivation.checked && !document.mdm.ProrateInstantly.checked){
	        document.mdm.ProrateOnDeactivation.checked = true;
		    document.mdm.ProrateInstantly.checked = false;
		  }
		}
		else
		{
		  document.mdm.ProrateOnDeactivation.checked = false;
		  document.mdm.ProrateInstantly.checked = false;
		  disableDiv('ProrateOnDeactivationDiv', true);
		  disableDiv('ProrateInstantlyDiv', true);
		}
	}
			
  </script>                                 
                                 
</HEAD>
<body onLoad="SizeWindow();">
<FORM name='mdm'>
<MDMTAB />

 <!-- The title of the dialog-->
	<table border="0" cellpadding="0" cellspacing="0" width="100%" >
		<tr><td Class='CaptionBar' nowrap><MDMLABEL Name="TEXT_KEYTERM_RECURRING_CHARGE">Recurring Charge</MDMLABEL></td></tr>
	</table>
	
<table border="0" width="100%">
	 <tr><td></td><td></td>
	   <td valign="top">
			<table border="0" cellpadding="0" cellspacing="0" width="100%">
			   <tr>
			 	   <td class="captionEWRequired" width="120px"><MDMLABEL name="TEXT_FIELD_NAME">Name</MDMLABEL>:&nbsp;&nbsp;</td>
				    <td><input readonly name="name" class="fieldNonEditable" size="50" type="text"></td>
			   </tr>
				<tr>
			       <td class="captionEWRequired"><MDMLABEL name="TEXT_FIELD_DISPLAY_NAME">Display Name</MDMLABEL>:&nbsp;&nbsp;</td>
				   <td><input name="DISPLAYNAMES" MultiLanguage="true" class="field" size="50" type="text"></td>
				 </tr>
				 <tr>
			       <td class="captionEWRequired"><MDMLABEL name="TEXT_FIELD_DESCRIPTION">Description</MDMLABEL>:&nbsp;&nbsp;</td>
				   <td><input name="DISPLAYDESCRIPTIONS" MultiLanguage="true" class="field" size="50" type="text"></td>
				 </tr>
			 		
          <tr><td>&nbsp;</td></tr>			 

				  <tr>
					<td Class="captionEWRequired"><MDMLABEL name="TEXT_CHARGE_IN">Charge In</MDMLABEL>:&nbsp;&nbsp;</td>
					<td> <SELECT  class='clsInputBox' name='ChargeInAdvance'></SELECT></td>
				  </tr>
      </table>
      
      <br>
      <!-- This DIV is used the gray all object included -->
			<DIV id='Proration' name='Proration' style='display: block;'>    
      
 				<table border="0" cellpadding="0" cellspacing="0" width="100%">
          
          <tr>
		     			<td Class="captionEWRequired" width="120px"><MDMLABEL name="TEXT_PRORATION">Proration</MDMLABEL>:&nbsp;&nbsp;</td>
				      <td Class='clsStandardText' >
					    <INPUT Name="ProrateOnActivation"   Type="CheckBox" onClick="updateProrationBasedOnField();">
						<MDMLABEL name="TEXT_PRORATE_ACTIVATION">Prorate On Activation</MDMLABEL>
				      </td>
			    </tr>
          <tr>
              <td></td>  
				      <td Class='clsStandardText' ><INPUT Name="ProrateOnUnsubscribeDate"   Type="CheckBox" [ProrateOnUnsubscribeDateComValue] onClick="updateDeactivation();updateProrationBasedOnField();">
              <MDMLABEL name="TEXT_PRORATE_UNSUBSCRIPTION">Prorate On Unsubscription Date</MDMLABEL></td>
			    </tr>
          <tr>
		          <td></td><td></td>
              <td Class='clsStandardText'> 
                    <DIV id='ProrateOnDeactivationDiv' name='ProrateOnDeactivationDiv' style='display: block;'>
						          <INPUT Name="ProrateOnDeactivation" Type="radio" [ProrateOnDeactivationComValue] onClick="document.mdm.ProrateInstantly.checked=false;updateProrationBasedOnField();">
							        <MDMLABEL name="TEXT_PRORATE_DEACTIVATION">Prorate On Deactivation</MDMLABEL>
                    </DIV>
              </td>
		    	  </tr>
		   		  <tr>
				       <td></td><td></td>
				       <td Class='clsStandardText'> 
                 <DIV id='ProrateInstantlyDiv' name='ProrateInstantlyDiv' style='display: block;'>
                   <INPUT Name="ProrateInstantly" Type="radio" [ProrateInstantlyComValue] onClick="document.mdm.ProrateOnDeactivation.checked=false;updateProrationBasedOnField();">
                   <MDMLABEL name="TEXT_PRORATE_INSTANTLY">Prorate Instantly</MDMLABEL>
                 </DIV>
               </td>
		    	  </tr>
		  <tr>
			<td Class="captionEW">&nbsp;</td>
			<td>
                <DIV id='ProrateOn' name='ProrateOn' style='display: block;'>
                      <MDMLABEL name="TEXT_PRORATE_BASEDON">Prorate</MDMLABEL>&nbsp;&nbsp;<select name="FixedProrationLength" size="1" Class='clsInputBox'></select>&nbsp;<MDMLABEL name="TEXT_DAYS_IN_PERIOD">days in period.</MDMLABEL>
                </DIV>
            </td>
		  </tr>
        </table>
          
      </DIV>                    

      <br>
      <table border="0" cellpadding="0" cellspacing="0">
        <tr>
          <td Class="captionEWRequired"><MDMLABEL name="TEXT_GROUP_CHARGES">Generate Group Charges</MDMLABEL>:&nbsp;&nbsp;</td>
          <td><INPUT Name="ChargePerParticipant" Type="Radio" Value="FALSE"><MDMLABEL name="TEXT_PER_SUBSCRIPTION">One charge per subscription</MDMLABEL></td>
        </tr>
        <tr>
          <td></td>
          <td><INPUT Name="ChargePerParticipant" Type="Radio" Value="TRUE"><MDMLABEL name="TEXT_PER_PARTICIPANT">One charge per subscription</MDMLABEL></td>
        </tr>          
      </table>

      <table border="0" cellpadding="0" cellspacing="0" width="100%">
      
#MDMIF IsUDRC
       <tr><td nowrap>&nbsp;</td></tr>
          <tr>
		     			<td nowrap Class="captionEWRequired"><MDMLABEL name="TEXT_UDRC">UDRC</MDMLABEL>:&nbsp;&nbsp;</td>
          </tr>            
		  		 <tr>
			       <td class="captionEWRequired"><MDMLABEL name="TEXT_UNIT_NAME"></MDMLABEL>:&nbsp;&nbsp;</td>
				     <td><input name="UnitName" class="field" size="50" type="text"></td>
				   </tr>
		  		 <tr>
			       <td class="captionEWRequired"><MDMLABEL name="TEXT_UNIT_DISPLAY_NAME"></MDMLABEL>:&nbsp;&nbsp;</td>
				     <td><input name="UNITDISPLAYNAMES" MultiLanguage="true" class="field" size="50" type="text"></td>
				   </tr>				   
           <tr>
		     			<td class="captionEWRequired"><MDMLABEL name="TEXT_RATING_TYPE"></MDMLABEL>:&nbsp;&nbsp;</td>
				      <td><SELECT  class='clsInputBox' name='RatingType'></SELECT></td>
          </tr>                    
           <tr>
		     			<td Class="captionEW"></td>
				      <td><INPUT Name="IntegerUnitValue" Type="Checkbox"><MDMLABEL name="IntegerUnitValue" type="caption"></MDMLABEL></td>
          </tr>
		  		 <tr>
			       <td class="captionEW"><MDMLABEL name="MinUnitValue" type="caption"></MDMLABEL>:&nbsp;&nbsp;</td>
				     <td nowrap><input name="MinUnitValue" class="field" size="20" type="text">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			       <MDMLABEL name="MaxUnitValue" type="caption"></MDMLABEL>:&nbsp;&nbsp;
				     <input name="MaxUnitValue" class="field" size="20" type="text"></td>             
				   </tr>
          </tr>          
           <tr>
		     			<td Class="captionEW" valign="bottom"><MDMLABEL name="UDRCUnitValueEnumeration" type="caption"></MDMLABEL>:&nbsp;&nbsp;</td>
				      <td>
                  [TEXT_UDRC_UNIT_VALUE_ENUMERATION_SEPARATOR_HELP]<br><input name="UDRCUnitValueEnumeration" class="field" size="50" type="text">
              </td>
          </tr>            
#MDMENDIF          

					
				</table>

			<table border="0" cellpadding="0" cellspacing="0" width="100%">
          
          <tr><td>&nbsp;</td><td>&nbsp;</td></tr>
		      <tr><td colspan=2>[BILLING_CYCLE_HTML_SUB_TEMPLATE]</td></tr> 
	        </table>
	    </td>			
      <td valign="top">
          <!-- Extended Properties -->
          <fieldset style="padding: 20 10 10 10;">
          <legend style="font-weight: normal;">Extended Properties</LEGEND>
          
          <MDMGrid Name="ExtendedProperties">Extended Properties</MDMGrid>
          <br>
          <center>
          <img src='..\localized\us\images\Icons\help_small.gif' alt='' border='0' align='absmiddle'>&nbsp;<a href="/MetraNetHelp/en-US/addingextendedproperties.hlp.htm" target="_blank" style="font-size: 9px;">What are extended properties?</a>
          </center>
      </td>   
	 </tr>
</table> 
<script>
  function handleCycleConfigurationDataChange()
  {
    updateProrationBasedOnField();
  }

  function isDailyCycleSelected()
  {
    test = frmsGetElementValue('mdm','Cycle__Relative');
	test = frmsGetElementValue('mdm','Cycle@BillingCycleTypeID');
	test = frmsGetElementValue('mdm','Cycle__Relative');
	test = frmsGetElementValue('mdm','Cycle__CycleTypeID');
	
    return ((frmsGetElementValue('mdm','Cycle__Relative')=="True"  && frmsGetElementValue('mdm','Cycle@BillingCycleTypeID')==3) || (frmsGetElementValue('mdm','Cycle__Relative')=="False"  && frmsGetElementValue('mdm','Cycle__CycleTypeID')==3))
  }

  function updateProrationBasedOnField()
  {
    if (isDailyCycleSelected())  //((frmsGetElementValue('mdm','Cycle__Relative')=="True"  && frmsGetElementValue('mdm','Cycle@BillingCycleTypeID')==3) || (frmsGetElementValue('mdm','Cycle__Relative')=="False"  && frmsGetElementValue('mdm','Cycle__CycleTypeID')==3))
    {
      //window.alert("handleCycleConfigurationDataChange: Disable proration");
      disableDiv('Proration',true);
      disableDiv('ProrateOn',true);
     //updateProrationBasedOnField();
    }
    else
    {
       disableDiv('Proration',false);
       if (document.mdm.ProrateOnDeactivation.checked || document.mdm.ProrateOnActivation.checked || document.mdm.ProrateInstantly.checked)
			 {
			 	ProrateOn.style.visibility="visible";
				disableDiv('ProrateOn',false);
			 }
       else
			 {
			 	ProrateOn.style.visibility="hidden";
				disableDiv('ProrateOn',true);
		   }
    }
	  updateDeactivation();
	}


  updateProrationBasedOnField();
</script>

<CENTER>
<!--On OK, we turn back on disabled DIVs to be able to read their values.  This is admittedly a bit of a kludge.-->
<BUTTON Name="OK"  Class="clsOKButton" OnClick="disableDiv('ProrateOnDeactivationDiv', false);disableDiv('ProrateInstantlyDiv', false);mdm_RefreshDialog(this);"><MDMLABEL Name='TEXT_OK'>OK</MDMLABEL></button>&nbsp;&nbsp;&nbsp;
<BUTTON Name="CANCEL" Class="clsOKButton" OnClick="mdm_RefreshDialog(this);"><MDMLABEL Name='TEXT_CANCEL'>Cancel</MDMLABEL></button>
</CENTER>
</FORM></BODY></HTML>
