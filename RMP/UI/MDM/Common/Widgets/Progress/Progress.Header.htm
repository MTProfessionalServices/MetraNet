<LINK Localized='TRUE' rel="STYLESHEET" type="text/css" href="/mdm/common/widgets/progress/ProgressStyles.css">  
    
<script language="JavaScript">
	var intIncrement=0;
  var strCaption = "";
  var n = 1;
  var bDone = false;

	function initialize(){
	 	document.all.ProgressBar.style.width = "1px";
		document.all.ProgressDiv.style.display  = "none";
    document.all.ProgressDiv.style.left = document.body.clientWidth / 2 - 150;
    document.all.ProgressDiv.style.top =  document.body.clientHeight / 2 - 100;
		intIncrement=0;	
    bDone = false;
    setPointer();
	}
  
  function setProgress(intPos, intMax){
		// Number of pixels to increment progress bar for each record
    intIncrement =  ((1 / intMax) * (200)) * intPos;	

    // Ses progress caption 
		if(strCaption != "") {
  		document.all.ProgressBarCaption.innerText = strCaption + intPos + " of " + intMax;
		}
		else{
	    document.all.ProgressBarCaption.innerText = "Progress: " + intPos + " of " + intMax;
		}
		
		// Move progress and make visible
    if(intIncrement==0) {
      //Don't show any progress
      document.all.ProgressBar.style.width = "0px";
      document.all.ProgressBarLeftCap.style.width = "0px";
      document.all.ProgressBarRightCap.style.width = "0px";
    }
    else{
  	  document.all.ProgressBar.style.width = intIncrement + "px";
      document.all.ProgressBarLeftCap.style.width = "2px";
      document.all.ProgressBarRightCap.style.width = "6px";    
    }
    
    document.all.ProgressDiv.style.display  = "inline";

		// Set to 100% if at end or gone to far
		if(intPos >= intMax){
		  	document.all.ProgressBar.style.width = 200 + "px";
        bDone = true;
		}
	}
  
  // Show progress with a custom delay
  function setProgressSlow(intPos, intMax, nDelay) {
   var slowItDown = setTimeout("setProgress("+ intPos + "," + intMax+")", nDelay * n)
   n++;
  }

  // Where are we going next?
  function setRouteTo(strRouteTo) {
    var routeTo = setTimeout("goTo('" + strRouteTo + "')", 100)
  }
  
  // Make sure we are done loading before we go...
  function goTo(strRouteTo){
    if(bDone) {
      document.location.href = strRouteTo;
    }
    else {
      var routeTo = setTimeout("goTo('" + strRouteTo + "')", 100)    
    }
  }
  
  // Force the Progress Bar to be done
  function setDone(){
		document.all.ProgressDiv.style.display  = "none";  
    resetPointer();
    bDone = true;
  }
  
  function setPointer() {
      if (document.all)
          for (var i=0;i < document.all.length; i++)
               document.all(i).style.cursor = 'wait';
  }
  
  function resetPointer() {
      if (document.all)
          for (var i=0;i < document.all.length; i++)
               document.all(i).style.cursor = 'default';
  }
  
</script>


