<HTML>
 <HEAD>
  <!-- $MVD$:app("RoboHELP HTML Edition by Blue Sky Software, portions by MicroVision Dev. Inc.","769") -->
  <!-- $MVD$:template("","0","0") -->
  <!-- $MVD$:fontset("Arial","Arial") -->
  <!-- $MVD$:fontset("Courier New","Courier New") -->
  <TITLE>HTTP Execute</TITLE>
  <META NAME="generator" CONTENT="RoboHELP by Blue Sky Software www.blue-sky.com HTML Edition">
  <SCRIPT LANGUAGE="javascript" TITLE="BSSC Special Effects" SRC="BSSCDHTM.js">
 </SCRIPT><LINK
  REL="StyleSheet" HREF="default.css"></HEAD>
  <BODY ONLOAD="BSSCOnLoad();" ONCLICK="BSSCOnClick();" ONUNLOAD="BSSCOnUnload();">
  <H1>
   Execute</H1>
  <ADDRESS CLASS="VbSample">
   Public Function Execute(</ADDRESS>
  <ADDRESS CLASS="VbSample">
   ByVal strMethod As String,</ADDRESS>
  <ADDRESS CLASS="VbSample">
   ByVal strURL As String,</ADDRESS>
  <ADDRESS CLASS="VbSample">
   Optional ByVal strParameters As String,</ADDRESS>
  <ADDRESS CLASS="VbSample">
   Optional ByRef varOutPut As Variant,</ADDRESS>
  <ADDRESS CLASS="VbSample">
   Optional ByRef varHeaders As Variant,</ADDRESS>
  <ADDRESS CLASS="VbSample">
   , Optional booTextFile As Boolean = False</ADDRESS>
  <ADDRESS CLASS="VbSample">
   ) As CHTTP_ERROR</ADDRESS>
  <ADDRESS CLASS="VbSample">
   <!-- $MVD$:spaceretainer() -->&nbsp;</ADDRESS>
  <P>
   <SPAN STYLE="font-weight : bold;">Description:</SPAN><BR>
   Execute an HTTP call.</P>
  <P>
   <SPAN STYLE="font-weight : bold;">Remark:</SPAN><BR>
   If you get twice the same file during the same W3Runner session, the 
   second get will use the file from the Microsoft Internet Explorer 
   cache. You can use W3Runner.ClearCache to force re download the file.</P>
  <P>
   <SPAN STYLE="font-weight : bold;">Parameters:</SPAN></P>
  <P>
   <TABLE WIDTH="100%" CELLPADDING="0" CELLSPACING="0" BORDER="1">
    <TR>
     <TD WIDTH="50%" BGCOLOR="SILVER" VALIGN=TOP>
      <P>
       <SPAN STYLE="font-weight : bold;">Part</SPAN></TD>
     <TD WIDTH="50%" BGCOLOR="SILVER" VALIGN=TOP>
      <P>
       <SPAN STYLE="font-weight : bold;">Description</SPAN></TD>
    </TR>
    <TR>
     <TD WIDTH="50%" VALIGN=TOP>
      <P>
       <SPAN STYLE="font-weight : normal;">strMethod</SPAN></TD>
     <TD WIDTH="50%" VALIGN=TOP>
      <P>
       GET, POST, HEAD.</TD>
    </TR>
    <TR>
     <TD WIDTH="50%" VALIGN=TOP>
      <P>
       strURL</TD>
     <TD WIDTH="50%" VALIGN=TOP>
      <P>
       The URL.</TD>
    </TR>
    <TR>
     <TD WIDTH="50%" VALIGN=TOP>
      <P>
       strParameters</TD>
     <TD WIDTH="50%" VALIGN=TOP>
      <P>
       The get or post url parameters.<BR>
       <BR>
       <SPAN STYLE="font-weight : bold;">Syntax:</SPAN></P>
      <ADDRESS CLASS="VbSample">
       name1=value1&amp;name2=value.</TD>
    </TR>
    <TR>
     <TD WIDTH="50%" VALIGN=TOP>
      <P>
       varOutPut</TD>
     <TD WIDTH="50%" VALIGN=TOP>
      <P>
       If defined with an empty variant the parameter will be set with the 
       content of the download. If the content of the file is a text/html or 
       application/octet-stream varOutPut will contain a string else a Byte Array.<BR>
       <BR>
       If defined with a string, the value will be use as a filename to 
       store the content of the download.</P>
      <P>
       If the HTTP call fail the parameter will be ignore you may have to 
       call the Property Status, StatusText and ResponseText to get more 
       information about the error</TD>
    </TR>
    <TR>
     <TD WIDTH="50%" VALIGN=TOP>
      <P>
       varHeaders</TD>
     <TD WIDTH="50%" VALIGN=TOP>
      <P>
       If defined will be set with the header string</TD>
    </TR>
    <TR>
     <TD WIDTH="50%" VALIGN=TOP>
      <P>
       booTextFile</TD>
     <TD WIDTH="50%" VALIGN=TOP>
      <P>
       Define that the content returned by the call is a text file content. 
       See the property TextFile.</TD>
    </TR>
   </TABLE></P>
  <P>
   <SPAN STYLE="font-weight : bold;">Sample:</SPAN><BR>
   </P>
  <ADDRESS CLASS="VbSample">
   Const DOWNLOAD_TIME_OUT = 10</ADDRESS>
  <ADDRESS>
   <!-- $MVD$:spaceretainer() -->&nbsp;</ADDRESS>
  <ADDRESS CLASS="VbSampleComment">
   ' Download a file and check some information</ADDRESS>
  <ADDRESS CLASS="VbSample">
   Dim strURL, varText</ADDRESS>
  <ADDRESS>
   <!-- $MVD$:spaceretainer() -->&nbsp;</ADDRESS>
  <ADDRESS CLASS="VbSample">
   strURL = &quot;http://www.mydotcom.com/default.htm&quot;</ADDRESS>
  <ADDRESS>
   <!-- $MVD$:spaceretainer() -->&nbsp;</ADDRESS>
  <ADDRESS CLASS="VbSample">
   Http.TimeOut = DOWNLOAD_TIME_OUT</ADDRESS>
  <ADDRESS>
   <!-- $MVD$:spaceretainer() -->&nbsp;</ADDRESS>
  <ADDRESS CLASS="VbSample">
   If Http.Execute(&quot;GET&quot;,strURL,,varText) = CHTTP_ERROR_OK Then</ADDRESS>
  <ADDRESS>
   <!-- $MVD$:spaceretainer() -->&nbsp;</ADDRESS>
  <ADDRESS CLASS="VbSample">
   &nbsp; If InStr(UCase(varText),&quot;HTTP-EQUIV&quot;) Then</ADDRESS>
  <ADDRESS>
   <!-- $MVD$:spaceretainer() -->&nbsp;</ADDRESS>
  <ADDRESS CLASS="VbSample">
   &nbsp; &nbsp; W3Runner.TRACE &quot;HTTP-EQUIV found&quot;<BR>
   &nbsp; Else</ADDRESS>
  <ADDRESS CLASS="VbSample">
   &nbsp; W3Runner.TRACE &quot;HTTP-EQUIV not found&quot;</ADDRESS>
  <ADDRESS CLASS="VbSample">
   &nbsp; End If</ADDRESS>
  <ADDRESS CLASS="VbSample">
   Else</ADDRESS>
  <ADDRESS CLASS="VbSample">
   &nbsp; W3Runner.TRACE &quot;HTTP Error &quot; &amp; Http.Status &amp; 
   &quot; &quot; &amp; Http.StatusText &amp; &quot; URL=&quot; &amp; 
   strURL, w3rERROR</ADDRESS>
  <ADDRESS CLASS="VbSample">
   End If</ADDRESS>
  <ADDRESS>
   <!-- $MVD$:spaceretainer() -->&nbsp;</ADDRESS>
  <ADDRESS>
   <!-- $MVD$:spaceretainer() -->&nbsp;</ADDRESS>
  <ADDRESS CLASS="VbSampleComment">
   ' Download a file and store the content in a local file</ADDRESS>
  <ADDRESS CLASS="VbSample">
   Dim strFileName, strURL</ADDRESS>
  <ADDRESS CLASS="VbSample">
   strURL = &quot;http://www.mydotcom.com/default.htm&quot;</ADDRESS>
  <ADDRESS CLASS="VbSample">
   strFileName = W3Runner.Environ(&quot;TEMP&quot;) &amp; &quot;\default.htm&quot;</ADDRESS>
  <ADDRESS>
   <!-- $MVD$:spaceretainer() -->&nbsp;</ADDRESS>
  <ADDRESS CLASS="VbSample">
   If Http.Execute(&quot;GET&quot;,strURL,,strFileName) = CHTTP_ERROR_OK Then</ADDRESS>
  <ADDRESS>
   <!-- $MVD$:spaceretainer() -->&nbsp;</ADDRESS>
  <ADDRESS CLASS="VbSample">
   &nbsp; W3Runner.TRACE &quot;File downloaded&quot;</ADDRESS>
  <ADDRESS CLASS="VbSample">
   Else</ADDRESS>
  <ADDRESS CLASS="VbSample">
   &nbsp; W3Runner.TRACE &quot;HTTP Error &quot; &amp; Http.Status &amp; 
   &quot; &quot; &amp; Http.StatusText &amp; &quot; URL=&quot; &amp; 
   strURL, w3rERROR</ADDRESS>
  <ADDRESS CLASS="VbSample">
   End If</ADDRESS>
  <P>
   See Also:</P>
  <P>
   <A HREF="HTTP_StatusText.htm">StatusText</A><BR>
   <A HREF="http_status.htm">Status</A><BR>
   <A HREF="Http_ResponseText.htm">ResponseText</A><BR>
   <A HREF="HTTP_TextFile.htm">TextFile</A>
 </BODY>
</HTML>