<?xml version="1.0" encoding="UTF-8"?>

<priceable_item>
  <name>Unit Dependent Recurring Charge</name>
  <description>Recurring charge based on a single subscription specific value.</description>
  <item_type>unit_dependent_recurring</item_type>
  <relationships>
    <parent></parent>
  </relationships>
  <parameter_table>metratech.com/UDRCTiered</parameter_table>
  <parameter_table>metratech.com/UDRCTapered</parameter_table>
  <counters></counters>
  <pipeline>
    <service_definition>metratech.com/udrecurringcharge</service_definition>
    <product_view>metratech.com/udrecurringcharge</product_view>
  </pipeline>
  <adjustment_type>
    <name>UnitDependentRecurringChargeFlatAdjustment</name>
    <description>Unit Dependent Recurring Charge Flat Adjustment</description>
    <displayname>Unit Dependent Recurring Charge Flat Adjustment</displayname>
    <CalculationEngine>1</CalculationEngine>
    <supportsBulk>Y</supportsBulk>
    <formula>
	    <![CDATA[
        Create Procedure DoAdjustmentCalc
	        -- inputs
	        @RCAdjustmentAmount DECIMAL,
	        -- outputs
	        @TotalAdjustmentAmount DECIMAL OUTPUT
	        as
        set @TotalAdjustmentAmount = @RCAdjustmentAmount
	    ]]>
    </formula>
    <applicabilityrules>
      <rule>IsTransactionPostbill</rule>
    </applicabilityrules>
    <Kind>3</Kind>
    <required_inputs>
      <input_val
        name="RCAdjustmentAmount"
        type="DECIMAL"
        displayname="Amount to adjust recurring charge"
      />
    </required_inputs>
    <outputs>
      <output_val
        name="TotalAdjustmentAmount"
        type="DECIMAL"
        displayname="Unit Dependent Recurring Charge Total Adjustment Amount"
      />
    </outputs>
    
   </adjustment_type>
  <adjustment_type>
    <name>UnitDependentRecurringChargePercentAdjustment</name>
    <description>Unit Dependent Recurring Charge Percent Adjustment</description>
    <displayname>Unit Dependent Recurring Charge Percent Adjustment</displayname>
    <CalculationEngine>1</CalculationEngine>
    <supportsBulk>Y</supportsBulk>
    <formula>
	    <![CDATA[
        Create Procedure DoAdjustmentCalc 
	        -- inputs
	        @RCAdjustmentPercent DECIMAL,
	        @Amount DECIMAL,
	        -- outputs
	        @TotalAdjustmentAmount DECIMAL OUTPUT
	        as
        set @TotalAdjustmentAmount = round(@Amount*@RCAdjustmentPercent*0.01, 2)
	    ]]>
    </formula>
    <applicabilityrules>
      <rule>IsTransactionPostbill</rule>
    </applicabilityrules>
    <Kind>3</Kind>
    <required_inputs>
      <input_val
        name="RCAdjustmentPercent"
        type="DECIMAL"
        displayname="Recurring Charge Adjustment Percentage"
      />
    </required_inputs>
    <outputs>
       <output_val
        name="TotalAdjustmentAmount"
        type="DECIMAL"
        displayname="Unit Dependent Recurring Charge Total Adjustment Amount"
      />
    </outputs>
   </adjustment_type>
</priceable_item>