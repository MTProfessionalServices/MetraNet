<?xml version="1.0" encoding="utf-8"?>
<xmlconfig>
    <mtsysconfigdata>
        <effective_date ptype="DATETIME">1998-11-19T00:00:00Z</effective_date>
        <timeout ptype="INTEGER">30</timeout>
        <configfiletype>CONFIG_DATA</configfiletype>
    </mtsysconfigdata>
    <mtconfigdata>
        <version ptype="INTEGER">1</version>
        <processor>
            <name>Unsubscribe</name>
            <progid>MetraTech.Accounts.PlugIns.Unsubscribe</progid>
            <description>
		Used for terminating all current and future subscription relationships of an account as on the date
        specified by the Hierarchy_startdate.  Primarily used to unsubscribe service accounts when they are "disconnected"
		</description>
            <condition>
			<![CDATA[
      
                CREATE PROCEDURE condition @_ExecutePlugin BOOLEAN OUTPUT,
                                          @Operation ENUM -- $ICE:('metratech.com/GSMCreation','Operation')$,
                                          @b_cansubscribe BOOLEAN,
                                          @ActionType ENUM -- $ICE:('metratech.com/accountcreation','ActionType')$,
                                          @b_CanParticipateInGSub BOOLEAN,
                                          @_ServiceID INTEGER 
                AS
                IF
                
                 (
                 		( (CAST(@_ServiceID AS ENUM) = #metratech.com/GSMDisconnect#) OR (CAST(@_ServiceID AS ENUM) = #metratech.com/GSMConnect#))
                 		AND
                    ((@b_cansubscribe = TRUE) OR (@b_CanParticipateInGSub = TRUE))
                    AND
				            ((upper(CAST(@ActionType AS VARCHAR)) = 'ACCOUNT') OR (upper(CAST(@ActionType AS VARCHAR)) = 'BOTH'))
				            AND
				            (@Operation = #metratech.com/Operation/Update#)
					       )
					
	                  SET @_ExecutePlugin = TRUE
       
                 ELSE
                    SET @_ExecutePlugin = FALSE
                  
      
      
      ]]></condition>
            <configdata>

        <AccountID>_AccountID</AccountID>
        <ActionType>ActionType</ActionType>
        <Operation>Operation</Operation>
        <b_cansubscribe>b_cansubscribe</b_cansubscribe>
        <b_CanParticipateInGSub>b_CanParticipateInGSub</b_CanParticipateInGSub>
        <hierarchy_startdate>hierarchy_startdate</hierarchy_startdate>    
      </configdata>
        </processor>
    </mtconfigdata>
</xmlconfig>