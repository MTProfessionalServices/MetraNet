<xmlconfig>
  <mtsysconfigdata>
    <effective_date ptype="DATETIME">1998-11-19T00:00:00Z</effective_date>
    <timeout ptype="INTEGER">30</timeout>
    <configfiletype>CONFIG_DATA</configfiletype>
  </mtsysconfigdata>

  <mtconfigdata>

 <version ptype="INTEGER">1</version>
 <!-- First processor configuration -->
 <processor>
  <name>CalcDuration</name>
  <progid>MetraPipeline.MTSQLInterpreter.1</progid>
  <description>Calculates Connection Duration</description>

	<!--
  <autotest>
    <file>calcduration.xml</file>
  </autotest>
  -->

  
  <!-- Processor specific configuration data -->
  <configdata>
 
  <Program><![CDATA[
		
		CREATE PROCEDURE calcduration 
		  @ConnectTime DATETIME 
      @DisconnectTime DATETIME  
      @Duration INTEGER OUTPUT
		AS
			DECLARE @timeConnectTime TIME;
			DECLARE @timeDisconnectTime TIME;
			DECLARE @intConnectTime INTEGER;
			DECLARE @intDisconnectTime INTEGER;
			SET @timeConnectTime = CAST (@ConnectTime AS TIME);
			SET @timeDisconnectTime = CAST (@DisconnectTime AS TIME);
			SET @intConnectTime = CAST (@timeConnectTime AS INTEGER);
			SET @intDisconnectTime = CAST (@timeDisconnectTime AS INTEGER);
			IF (@intDisconnectTime < @intConnectTime)
          RAISERROR('Disconnect time ' + CAST(@intDisconnectTime AS VARCHAR) + ' cannot be smaller than connection time ' + CAST(@intConnectTime AS VARCHAR))
			SET @Duration = @intDisconnectTime - @intConnectTime;
	 
  ]]></Program> 
    
  </configdata>

 </processor>

  </mtconfigdata>

</xmlconfig>

