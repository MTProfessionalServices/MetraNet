<xmlconfig>
  <mtsysconfigdata>
    <effective_date ptype="DATETIME">1998-11-19T00:00:00Z</effective_date>
    <timeout ptype="INTEGER">30</timeout>
    <configfiletype>CONFIG_DATA</configfiletype>
  </mtsysconfigdata>

  <mtconfigdata>

 <version ptype="INTEGER">1</version>
 <!-- First processor configuration -->
 <processor>
  <name>CalcMinCost</name>
  <progid>MetraPipeline.MTSQLInterpreter.1</progid>
  <description>Calculates minimum connection charge base on UOM</description>

	<!--
  <autotest>
    <file>calcmincost.xml</file>
  </autotest>
  -->

  
  <!-- Processor specific configuration data -->
  <configdata>
 
  <Program><![CDATA[
		
		CREATE PROCEDURE calcmincost
 			 @BaseTransportMinCharge DECIMAL 
				@TransportMinUOM ENUM -- $ICE:('metratech.com/audioconfconnection','UOM')$
				@BaseTransportRate DECIMAL 
				@BridgeMinCharge DECIMAL 
        @BridgeMinUOM ENUM -- $ICE:('metratech.com/audioconfconnection','UOM')$
        @BridgeRate DECIMAL
				@IntlRate DECIMAL 
        @TransportMinCost DECIMAL OUTPUT
        @BridgeMinCost DECIMAL OUTPUT
			AS
			DECLARE @strTransportMinUOM VARCHAR;
			DECLARE @strBridgeMinUOM VARCHAR;

			SET @TransportMinCost = 0.0;
			SET @BridgeMinCost = 0.0;
			SET @strTransportMinUOM = CAST(@TransportMinUOM AS VARCHAR);
			SET @strBridgeMinUOM = CAST(@BridgeMinUOM AS VARCHAR);
			IF(@strTransportMinUOM = 'USD')
				SET @TransportMinCost = @BaseTransportMinCharge;
			ELSE
				SET @TransportMinCost = (@BaseTransportRate + @IntlRate) * @BaseTransportMinCharge;
			IF(@strBridgeMinUOM = 'USD')
				SET @BridgeMinCost = @BridgeMinCharge;
			ELSE
				SET @BridgeMinCost = @BridgeRate  * @BridgeMinCharge;
	
  ]]></Program> 
    
  </configdata>

 </processor>

  </mtconfigdata>

</xmlconfig>



