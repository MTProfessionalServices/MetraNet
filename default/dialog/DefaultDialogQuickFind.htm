<HTML>
<HEAD>
<LINK Localized='TRUE' rel="STYLESHEET" type="text/css" href="/mam/default/localized/en-us/styles/styles.css">  
<LINK Localized='TRUE' rel="STYLESHEET" type="text/css" href="/mam/default/localized/en-us/styles/MAMMenu.css">

<SCRIPT Language="JavaScript1.2">
// -----------------------------------------------------------------------------
// FUNCTION    : mdm_GetComboBoxValue
// DESCRIPTION : Ask to the mdm to get the current combo box value
function mdm_GetComboBoxValue(strForm, strElement)
{
  var i, intLen;
  
  //Check for the form element to exist
  if(eval('document.' + strForm + '.' + strElement) != null) {
    intLen = eval('document.' + strForm + '.' + strElement + '.length');
    if(intLen != null ) {
      for(i=0; i < intLen; i++) {
        if(eval('document.' + strForm + '.' + strElement + '.options[' + i + '].selected') == true)
          return(eval('document.' + strForm + '.' + strElement + '.options[' + i + '].value'));
      }
    }
  }

  return(''); //unable to get the index

}

function RectifySearchString(strInput)
{	
	regex = /\%\%/gi;	
	return strInput.replace(regex, "%");
}

// -----------------------------------------------------------------------------
// FUNCTION    : DoFind
// DESCRIPTION : Run the find operation
function DoFind(){
    
    var strValue = document.mdm.Value.value;
    var strSearchOn = mdm_GetComboBoxValue("mdm", "SearchOn");
    
    var strValueSystemUser = document.mdm.ValueSystemUser.value;
    var strSearchOnSystemUser = mdm_GetComboBoxValue("mdm", "SearchOnSystemUser");

    var strParam;
    
    // Find Account
    if(strValue.length){
      strParam = "SearchOn=" + strSearchOn + "&";
      strValue = RectifySearchString(strValue);
      strParam +="Value=" + encodeURIComponent(strValue) + "&";
      strParam +="AccountTypeName='CORPORATEACCOUNT','CORESUBSCRIBER','DEPARTMENTACCOUNT','INDEPENDENTACCOUNT'&"; // Account Tyes to search    
      parent.frames['main'].location='[SUBSCRIBER_FIND_BROWSER]?'+strParam;
    }
    // Find System User
    else if(strValueSystemUser.length)
    {
      strParam = "SearchOn=" + strSearchOnSystemUser + "&";
      strParam +="Value=" + encodeURIComponent(strValueSystemUser) + "&";
      strParam +="AccountTypeName='SYSTEMACCOUNT'&"; // Account Tyes to search    
      parent.frames['main'].location='[SYSTEMUSER_FIND_BROWSER]?'+strParam;
    }
    else{
      alert("[MAM_ERROR_1009]");
    }
}

function DoAdvancedDialog(){
  parent.frames["main"].location='[ADVANCED_FIND_DIALOG]';  
}

function DoAdvancedDialogSystemUser(){
  parent.frames["main"].location='[SYSTEM_USER_FIND_DIALOG]';
}

function DoAdvancedDialogGeneric(){
 parent.frames["main"].location='[GENERIC_FIND_SELECTOR_DIALOG]?mdmCurrentTab=IndependentAccount';
}


function ClearValues(obj){

  if(obj.name != "Value")
    document.mdm.Value.value = "";
    
  if(obj.name != "ValueSystemUser")
    document.mdm.ValueSystemUser.value = "";
}
function SetFocus()
{
  if(document.mdm.Value)
    document.mdm.Value.focus();
}

</SCRIPT>

		<!-- Drag & Drop Functions --> 
    <script language="Javascript" src="js/dragdrop.js"></script> 

    <!-- Suggest Box Inludes --> 
    <link rel="STYLESHEET" type="text/css" href="/Suggest/Suggest.css">  
    <script language="JavaScript" src="/Suggest/Suggest.js"></script>
    		
</HEAD>
<BODY onload="SetFocus();SuggestLoad();" onDrag="fOnDrag();" onDragEnd="fOnDragEnd();" onDragLeave="fOnDragLeave();" onDragEnter="fOnDragEnter();" onDragStart="fOnDragStart();" onDragOver="fOnDragOver();" onDrop="fOnDrop();" style="background-color:#003B8E;margin:10px 14px 6px 5px;">

<!-- DIV for dragable shadow --> 
<div class="clsDragDiv" id="dragDiv"></div>

<FORM name='mdm' OnSubmit='DoFind();return false;'>

<INPUT Name="mdmAction"     Type="Hidden" Value="">
<INPUT Name="mdmProperty"   Type="Hidden" Value="">
 
<MDMSecurity Capabilities="Manage Account Hierarchies, Manage independent accounts, Manage Owned Accounts" Operator="OR">

<a name='aAdvancedFindGeneric' class="clsAdvancedFind" href="javascript:DoAdvancedDialogGeneric();">Generic Advanced Find</a> 
<br>
<!-- Account Quick Find -->

<div class="clsFindTab" style="position:relative;z-index=-100">
    <table class="TabContainer" border="0" cellpadding="1" cellspacing="0">
      <tr> 
        <td class="MenuTab">Find Account</td>
      </tr>
		<tr><td class="MenuItem">
		<table border="0" cellpadding="1" cellspacing="0">
      <tr valign="baseline">
        <td> 
          <SELECT Class='clsFindInputBox' style="width:130px;" name="SearchOn"></SELECT>
        </td>
        <td nowrap>
        <a name='aAdvancedFind' class="clsAdvancedFind" href="javascript:DoAdvancedDialog();">Advanced</a> 
        </td>
      </tr>
      <tr valign="baseline"> 
        <td nowrap width="175">
          <input onClick="ClearValues(this);" name="Value" id="Value" type="text" onkeyup="SendQuery(this, 'ACCOUNT_FINDER', document.mdm.SearchOn.value + ',' + document.mdm.Value.value + ',' + '_NAMESPACETYPE' + ',' + 'system_mps' + ',' + 'ACCOUNTTYPENAME' + ',' + '\'CORPORATEACCOUNT\'|\'CORESUBSCRIBER\'|\'DEPARTMENTACCOUNT\'|\'INDEPENDENTACCOUNT\'', '[SERIALIZED_CONTEXT]');" style="WIDTH:130px" autocomplete="off" class="clsFindInputBox" dropEvent="GetFieldID">
          <a href="#" onClick="SendQueryClick(document.mdm.Value, 'ACCOUNT_FINDER', document.mdm.SearchOn.value + ',' + document.mdm.Value.value + ',' + '_NAMESPACETYPE' + ',' + 'system_mps' + ',' + 'ACCOUNTTYPENAME' + ',' + '\'CORPORATEACCOUNT\'|\'CORESUBSCRIBER\'|\'DEPARTMENTACCOUNT\'|\'INDEPENDENTACCOUNT\'', '[SERIALIZED_CONTEXT]');" ID="Button1" name="Button1">
            <img src="/mam/default/localized/en-us/images/search.gif" alt="Inline Search" style="border:0;">
          </a>
          <img name="suggestLoading_Value" id="suggestLoading_Value" class="clsSuggestLoading" src="/suggest/suggest.gif"><br>
          <div name="autocomplete_Value" id="autocomplete_Value" class="clsSuggestBox" style="WIDTH:200px;"></div>   
          <iframe id="DivShim_Value" src="javascript:false;" scrolling="no" frameborder="0" style="position:absolute; width:0px; height:0px; top:0px; left:0px; display:none;"></iframe>             
        </td>
        <td nowrap>
        <a name='aGo' class="clsGo" href="javascript:DoFind();"><img align="absmiddle" src="/mam/default/localized/en-us/images/go.gif" border="0">&nbsp;[TEXT_GO]</a>
        </td>
      </tr>
		</table>
		</td></tr>
    </table>
    <br />
</div>


<!-- System User Quick Find -->
<div class="clsFindTab"  style="position:relative;z-index=-120">
    <table class="TabContainer" border="0" cellpadding="1" cellspacing="0" ID="Table5">
      <tr> 
        <td class="MenuTab">Find System User</td>
      </tr>
		<tr><td class="MenuItem">
		<table border="0" cellpadding="1" cellspacing="0" ID="Table6">
      <tr valign="baseline">
        <td> 
          <SELECT Class='clsFindInputBox' style="width:130px;" name="SearchOnSystemUser" ID="SearchOnSystemUser"></SELECT>
        </td>
        <td nowrap>
        <a name='aAdvancedFind2' class="clsAdvancedFind" href="javascript:DoAdvancedDialogSystemUser();">Advanced</a> 
        </td>
      </tr>
      <tr valign="baseline"> 
        <td nowrap width="175">
          <input onClick="ClearValues(this);" name="ValueSystemUser" id="ValueSystemUser" type="text" onkeyup="SendQuery(this, 'ACCOUNT_FINDER', document.mdm.SearchOnSystemUser.value + ',' + document.mdm.ValueSystemUser.value + ',' + '_NAMESPACETYPE' + ',' + 'system_user' + ',' + 'ACCOUNTTYPENAME' + ',' + '\'SYSTEMACCOUNT\'', '[SERIALIZED_CONTEXT]');" style="WIDTH:130px" autocomplete="off" class="clsFindInputBox" dropEvent="GetFieldID">
          <a href="#" onClick="SendQueryClick(document.mdm.ValueSystemUser, 'ACCOUNT_FINDER', document.mdm.SearchOnSystemUser.value + ',' + document.mdm.ValueSystemUser.value + ',' + '_NAMESPACETYPE' + ',' + 'system_user' + ',' + 'ACCOUNTTYPENAME' + ',' + '\'SYSTEMACCOUNT\'', '[SERIALIZED_CONTEXT]');" ID="A2" name="Button1">
            <img src="/mam/default/localized/en-us/images/search.gif" alt="Inline Search" style="border:0;">
          </a>
          <img name="suggestLoading_ValueSystemUser" id="suggestLoading_ValueSystemUser" class="clsSuggestLoading" src="/suggest/suggest.gif"><br>
          <div name="autocomplete_ValueSystemUser" id="autocomplete_ValueSystemUser" class="clsSuggestBox" style="WIDTH:200px"></div>      
          <iframe id="DivShim_ValueSystemUser" src="javascript:false;" scrolling="no" frameborder="0" style="position:absolute; width:0px; height:0px; top:0px; left:0px; display:none;"></iframe>           
        </td>
        <td nowrap>
        <a name='aGo' class="clsGo" href="javascript:DoFind();"><img align="absmiddle" src="/mam/default/localized/en-us/images/go.gif" border="0">&nbsp;[TEXT_GO]</a>
        </td>
      </tr>
		</table>
		</td></tr>
    </table>
    <br />
</div>

<!-- Recent Account List -->
<div class="clsFindTab" style="position:relative;z-index=-140">
    <table class="TabContainer" border="0" cellpadding="1" cellspacing="0" ID="Table3">
      <tr> 
        <td class="MenuTab">Recent Account List</td>
      </tr>
		<tr><td class="MenuItem">
		<table ID="Table4">
      <tr valign="baseline"> 
        <td>
          [RECENT_ACCOUNT_LIST]
        </td>
       </tr>
		</table>
		</td></tr>
    </table>
</div>

</MDMSecurity>
</FORM>
</BODY>
</HTML>

