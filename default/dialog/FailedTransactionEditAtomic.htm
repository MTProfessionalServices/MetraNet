<HTML>
 <HEAD>
  <TITLE><LABEL NAME="TEXT_FAILED_TRANSACTIONS_EDIT_FAILED_TRANSACTION">Edit Failed Transaction...</LABEL></TITLE>
  <LINK rel="STYLESHEET" type="text/css" href="/mom/default/localized/en-us/styles/styles.css">  
 </HEAD>

<BODY>

<FORM name="mdm">

<!-- Title Bar -->
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" Width="100%">
 <TR>
  <TD Class="CaptionBar" nowrap><LABEL NAME="TEXT_FAILED_TRANSACTIONS_EDIT_FAILED_TRANSACTION">Edit Failed Transaction</LABEL>&nbsp;&nbsp;&nbsp;&nbsp;
<button OnClick="mdm_RefreshDialog(this)" name="ok" Class="clsOkButton">Save</button>
<button onclick="mdm_RefreshDialog(this)" name="cancel" Class="clsOkButton"><MDMLABEL Name="TEXT_CANCEL"></MDMLABEL></button>
<button class='clsButtonBlueXLarge' id='EditMapping' onclick="window.open('[AUDIT_LOG_LIST_DIALOG]?EntityType=5&EntityId=<LABEL Name="CaseNumber" Type="Value"></LABEL>&Title=Audit%20History%20For%20Failed%20Transaction%20Case%20Number%20<LABEL Name="CaseNumber" Type="Value"></LABEL>','', 'height=400,width=700, resizable=yes, scrollbars=yes, status=yes'); return false;">View Audit Trail</button>
  </TD>
 </TR>
</TABLE>

<TABLE  BORDER="0"  CELLPADDING="0" CELLSPACING="0">
<TR><td width="50%" valign="top">
<TABLE  BORDER="0"  CELLPADDING="0" CELLSPACING="0">
 <TR>
    <TD nowrap class="captionEW" style="font-weight:bold;">Case Number:&nbsp;&nbsp;</TD>
    <TD class=""><LABEL Name="CaseNumber" Type="Value"></LABEL></TD>
 </TR>
 <TR>
    <TD class="captionEW" style="font-weight:bold;">Case Status:&nbsp;&nbsp;</TD>
    <TD class=""><LABEL Name="CaseStatusReasonCode" Type="Value"></LABEL></TD>
 </TR>
 <TR>
    <td nowrap class="captionEW" style="font-weight:bold;">Failed Transaction Id:&nbsp;&nbsp;</td>
    <TD class=""><LABEL Name="TEXT_FAILED_TRANSACTION_FAILURE_ID">ID</LABEL></TD>
 </TR>
 <TR>
    <TD nowrap class="captionEW" style="font-weight:bold;">Service With Error:&nbsp;&nbsp;</TD>
    <TD class=""><LABEL Name="ServiceName" Type="Value">Test Service</LABEL></TD>
 </TR>
 <TR>
    <TD nowrap class="captionEW" style="font-weight:bold;">Error Message:&nbsp;&nbsp;</TD>
    <TD class=""><LABEL Name="ErrorMessage" Type="Value">Plugin failed</LABEL></TD>
 </TR> 

</TABLE>
</TD>

<TD>
<input type="hidden" name="CaseStatus">
<input type="hidden" name="CaseStatusReasonCode">
<input type="hidden" name="CaseStatusUpdated">
<table border="0" cellspacing="2" cellpadding="2" align="right">
 <TR>
    <TD width="32">&nbsp;</TD> 
    <td nowrap class="captionEWRequired" style="vertical-align: text-top;">Status:&nbsp;</td>
    <td>
          <table class="clsDialogEditTable" cellspacing="1" cellpadding="2" width="100%">
                      
                     <tr id="state0">
                        <td align="center" valign="top" class="TableCell">
                           <input type="radio" name="NewStatus" value="N" onClick="setStatusUpdated(this)">
                        </td>
                        <td align="left" class="TableCell" title="This case/failed transaction is currently unresolved.">
                           <strong>Open</strong>
                        </td>
                     </tr>
                     <tr id="state1">
                        <td align="center" valign="top" class="TableCell">
                           <input type="radio" name="NewStatus" value="I" onClick="setStatusUpdated(this)">
                        </td>
                        <td align="left" class="TableCell" title="This case/failed transaction is currently unresolved but is being investigated.">
                           <strong>Under Investigation</strong><BR>
                           Reason Code:
                                  <SELECT class="clsInputBox" name="InvestigationReasonCode" onClick="document.all.NewStatus[1].checked=true;" onChange="setStatusUpdated(null)"></SELECT>
                           
                        </td>
                     </tr>
                     <tr id="state2">
                        <td align="center" valign="top" class="TableCell">
                           <input type="radio" name="NewStatus" value="C" onClick="setStatusUpdated(this);">
                        </td>
                        <td align="left" class="TableCell" title="This case/failed transaction has been resolved and is ready to be resubmitted to the system for processing.">
                                <strong>Corrected - Pending Resubmit</strong>
                               <input type="checkbox" disabled name="ResubmitNow" onClick="setStatusUpdated(null);">Resubmit Now

		                   </td>
                     </tr>
                     <tr id="state3">
                        <td align="center" valign="top" class="TableCell">
                           <input type="radio" name="NewStatus" value="P" onClick="setStatusUpdated(this)">
                        </td>
                        <td align="left" class="TableCell" title="This case/failed transaction cannot be resolved or it is not cost effective to do so.">
                                <strong>Dismissed</strong><BR>
                           Reason Code:
                                  <SELECT class="clsInputBox" name="DismissedReasonCode" onClick="document.all.NewStatus[3].checked=true;" onChange="setStatusUpdated(null)">

                                  </SELECT>
                        </td>
                     </tr>                                     
        </TABLE>
    </TD>
 </TR>
 <TR>
    <TD width="32">&nbsp;</TD> 
    <td class="captionEWRequired" style="vertical-align: text-top;">Comment:&nbsp;</td>
    <TD class="fieldRequired"><TEXTAREA class="clsInputBox" cols=55 rows=4 name="Comment"></TEXTAREA></TD>
 </TR>

</TABLE>

<SCRIPT LANGUAGE="JavaScript">
function setInitialStatusSelection()
{
  //Set the correct radio button for status
  buttonGroup=document.mdm.NewStatus;
  for ( var i=0; i < buttonGroup.length; i++ )
  {
    //alert(buttonGroup[i].value);
    if (buttonGroup[i].value==document.mdm.CaseStatus.value)
    {
      buttonGroup[i].checked = true;
      //Removed the clearing out of the onClick event for the current value because changing the status back to this value
      //did not correctly set/reset the ResubmitNow checkbox.
      //buttonGroup[i].onclick=""; 
      break;
    }
  }
  
  if (document.mdm.CaseStatus.value=="C")
  {
    document.all.ResubmitNow.disabled = false;
  }
  else
  {
    document.all.ResubmitNow.disabled = true;
    document.all.ResubmitNow.checked  = false;
  }
}

function setStatusUpdated(objClicked)
{
  //window.alert("setStatusUpdated");

  document.mdm.CaseStatusUpdated.value = "T"; 
    
  if(objClicked!=null)
  {
    //window.alert('Value is ' +  objClicked.value );
      if(objClicked.value=="C")
      {
          document.all.ResubmitNow.disabled = false;
      }
      else
      {
          document.all.ResubmitNow.disabled = true;
          document.all.ResubmitNow.checked  = false;
      }
  }
}

setInitialStatusSelection();
</SCRIPT>

</TD>
</TR>
</TABLE>
<!-- End Case Information -->

<BR>

<!-- Title Bar -->
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" Width="100%">
 <TR>
  <TD Class="CaptionBar" nowrap><LABEL NAME="TEXT_FAILED_TRANSACTIONS_EDIT_FAILED_TRANSACTION">Edit Failed Transaction...</LABEL>   
  <LABEL Name="TEXT_FAILED_TRANSACTION_FAILURE_ID">ID</LABEL><!-- The TEXT is programmatically added to the dictionary -->
  </TD>
 </TR>
</TABLE>
<BR>

<!-- Property Table -->
<BR>
<TABLE Width="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0" id="propertyTable">
<TR>
  <TD Class='TableHeader' NoWrap>Property</TD>
  <TD Class='TableHeader' NoWrap>Type</TD>
  <TD Class='TableHeader' NoWrap>Length</TD>
  <TD Class='TableHeader' NoWrap>Required</TD>
  <TD Class='TableHeader' NoWrap>Metered Status</TD>
  <TD Class='TableHeader' NoWrap>Meter Status</TD>
  <TD Class='TableHeader' NoWrap>Value</TD>
<TR>
[PROPERTIES] <!-- Do not touche this [] Tag - F.Torres-->
 
</TABLE>
<BR>
<INPUT Type="CheckBox" Name="mdmCheckRequiredField" CHECKED>Check For Required Fields
<BR>


</FORM>
<script type="text/javascript">
  var initialize = function () {
    var doubleElementCssClass = 'class_ft_edit_double',
        decimalElementCssClass = 'class_ft_edit_decimal';
    if (window.DECIMAL_SEPARATOR) {
      var propertyTable = document.getElementById('propertyTable');
      if (propertyTable) {
        var allInputTextElements = propertyTable.querySelectorAll('input[type=text]');
        if (allInputTextElements.length > 0) {
          for (var i = 0, maxLength = allInputTextElements.length; i < maxLength; i++) {
            var element = allInputTextElements[i];
            if (element) {
              var elementCssClasesStr = element.attributes['class'].value;
              var classes = elementCssClasesStr.split(',');
              if (classes) {
                for (var item = 0, allClases = classes.length; item < allClases; item++) {
                  if (classes[item] === doubleElementCssClass || classes[item] === decimalElementCssClass) {
                    element.value = element.value.replace('.', window.DECIMAL_SEPARATOR);
                  }
                }
              }
            }
          }
        }
      }
    }
  } ();
</script>
</BODY>
</HTML>
